{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Workgroup - group 3"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## **Math Demonstrations**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. Prove the Frisch–Waugh–Lovell theorem"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Given the model:\n",
    "\\begin{align*}\n",
    "y &= D \\beta_1 + W \\beta_2 + \\mu\n",
    "\\end{align*}\n",
    "where $y$ is an $n \\times 1$ vector, $D$ is an $n \\times k_1$ matrix, $\\beta_1$ is a $k_1 \\times 1$ vector, $W$ is an $n \\times k_2$ matrix, $\\beta_2$ is a $k_2 \\times 1$ vector, and $\\mu$ is an $n \\times 1$ vector of error terms.\n",
    "\n",
    "We can construct the following equation:\n",
    "\n",
    "\\begin{align*}\n",
    "\\epsilon_y &= \\epsilon_D \\phi + \\xi\n",
    "\\end{align*}\n",
    "\n",
    "Running $y$ on $W$, we get:\n",
    "\n",
    "\\begin{align*}\n",
    "y &= W\\hat{\\alpha}_1 + \\epsilon_y \\iff \\epsilon_y &= y - W\\hat{\\alpha}_1\n",
    "\\end{align*}\n",
    "\n",
    "Similarly, running $D$ on $W$ gives us:\n",
    "\n",
    "\\begin{align*}\n",
    "D &= W\\hat{\\alpha}_2 + \\epsilon_D \\iff \\epsilon_D &= D - W\\hat{\\alpha}_2\n",
    "\\end{align*}\n",
    "\n",
    "Running $\\epsilon_y$ on $\\epsilon_D$:\n",
    "\\begin{align*}\n",
    "y - W \\hat{\\alpha}_1 &= (D - W \\hat{\\alpha}_2) \\phi + \\xi \\\\\n",
    "y &= W \\hat{\\alpha}_1 + (D - W \\hat{\\alpha}_2) \\phi + \\xi \\\\\n",
    "y &= W \\hat{\\alpha}_1 + D \\phi - W \\hat{\\alpha}_2 \\phi + \\xi \\\\\n",
    "y &= D \\phi + W (\\hat{\\alpha}_1 - \\hat{\\alpha}_2 \\phi) + \\xi\n",
    "\\end{align*}\n",
    "\n",
    "Comparing the original model with this, we can see that:\n",
    "\\begin{align*}\n",
    "    \\beta_1 &= \\phi \\\\\n",
    "    \\beta_2 &= \\hat{\\alpha}_1 - \\hat{\\alpha}_2 \\phi \\\\\n",
    "    \\mu &= \\xi\n",
    "\\end{align*}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. Show that the Conditional Expectation Function minimizes the expected squared error."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Given the model:\n",
    "\\begin{align*}\n",
    "Y &= m(X) + e\n",
    "\\end{align*}\n",
    "where $m(X)$ represents the conditional expectation of $Y$ on $X$. Let's define an arbitrary model:\n",
    "\\begin{align*}\n",
    "Y &= g(X) + w\n",
    "\\end{align*}\n",
    "where $g(X)$ represents any function of $X$.\n",
    "\n",
    "Working with the expected squared error from the arbitrary model:\n",
    "\\begin{align*}\n",
    "E[(Y-g(X))^2] &= E[(Y-m(X) + m(X)-g(X))^2] \\\\\n",
    "&= E[(Y-m(X))^2 + 2(Y-m(X))(m(X)-g(X)) + (m(X)-g(X))^2] \\\\\n",
    "&= E[e^2] + 2E[(Y-m(X))(m(X)-g(X))] + E[(m(X)-g(X))^2]\n",
    "\\end{align*}\n",
    "Using the law of iterated expectations:\n",
    "\\begin{align*}\n",
    "E[(Y-g(X))^2] &= E[e^2] + 2E[E[(Y-m(X))(m(X)-g(X)) | X]] + E[(m(X)-g(X))^2]\n",
    "\\end{align*}\n",
    "Since $m(X)$ and $g(X)$ are functions of $X$, the term $(m(X)-g(X))$ can be thought of as constant when conditioning on $X$. Thus:\n",
    "\\begin{align*}\n",
    "E[(Y-g(X))^2] &= E[e^2] + 2E[E[Y-m(X) | X](m(X)-g(X))] + E[(m(X)-g(X))^2]\n",
    "\\end{align*}\n",
    "It is important to note that $E[Y-m(X) | X] = 0$ by definition of $m(X)$, so we get:\n",
    "\\begin{align*}\n",
    "E[(Y-g(X))^2] &= E[e^2] + E[(m(X)-g(X))^2]\n",
    "\\end{align*}\n",
    "Because the second term in the equation is always non-negative, it is clear that the function is minimized when $g(X)$ equals $m(X)$. In which case:\n",
    "\\begin{align*}\n",
    "E[(Y-g(X))^2] &= E[e^2]\n",
    "\\end{align*}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.020568,
     "end_time": "2021-02-21T17:17:47.770707",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.750139",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "This notebook contains an example for teaching."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.018579,
     "end_time": "2021-02-21T17:17:47.809138",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.790559",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## **Replication 1 - Code**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.019386,
     "end_time": "2021-02-21T17:17:47.847419",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.828033",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "In the previous lab, we already analyzed data from the March Supplement of the U.S. Current Population Survey (2015) and answered the question how to use job-relevant characteristics, such as education and experience, to best predict wages. Now, we focus on the following inference question:\n",
    "\n",
    "What is the difference in predicted wages between men and women with the same job-relevant characteristics?\n",
    "\n",
    "Thus, we analyze if there is a difference in the payment of men and women (*gender wage gap*). The gender wage gap may partly reflect *discrimination* against women in the labor market or may partly reflect a *selection effect*, namely that women are relatively more likely to take on occupations that pay somewhat less (for example, school teaching)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.018623,
     "end_time": "2021-02-21T17:17:47.884840",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.866217",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "To investigate the gender wage gap, we consider the following log-linear regression model\n",
    "\n",
    "\\begin{align}\n",
    "\\log(Y) &= \\beta'X + \\epsilon\\\\\n",
    "&= \\beta_1 D  + \\beta_2' W + \\epsilon,\n",
    "\\end{align}\n",
    "\n",
    "where $D$ is the indicator of being female ($1$ if female and $0$ otherwise) and the\n",
    "$W$'s are controls explaining variation in wages. Considering transformed wages by the logarithm, we are analyzing the relative difference in the payment of men and women."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "library(ggplot2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.018169,
     "end_time": "2021-02-21T17:17:47.921363",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.903194",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Data analysis"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.018446,
     "end_time": "2021-02-21T17:17:47.958377",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.939931",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We consider the same subsample of the U.S. Current Population Survey (2015) as in the previous lab. Let us load the data set."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:48.027996Z",
     "iopub.status.busy": "2021-02-21T17:17:48.025377Z",
     "iopub.status.idle": "2021-02-21T17:17:48.193706Z",
     "shell.execute_reply": "2021-02-21T17:17:48.192123Z"
    },
    "papermill": {
     "duration": 0.217167,
     "end_time": "2021-02-21T17:17:48.193957",
     "exception": false,
     "start_time": "2021-02-21T17:17:47.976790",
     "status": "completed"
    },
    "scrolled": true,
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>5150</li><li>20</li></ol>\n"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item 5150\n",
       "\\item 20\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. 5150\n",
       "2. 20\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "[1] 5150   20"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "load(\"../../data/wage2015_subsample_inference.Rdata\")\n",
    "dim(data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***Variable description***\n",
    "\n",
    "- occ : occupational classification\n",
    "- ind : industry classification\n",
    "- lwage : log hourly wage\n",
    "- sex : gender (1 female) (0 male)\n",
    "- shs : some high school\n",
    "- hsg : High school graduated\n",
    "- scl : Some College\n",
    "- clg: College Graduate\n",
    "- ad: Advanced Degree\n",
    "- ne: Northeast\n",
    "- mw: Midwest\n",
    "- so: South\n",
    "- we: West\n",
    "- exp1: experience"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Filtering data to focus on college-advanced-educated workers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "data <- data[data$ad == 1 | data$scl == 1 | data$clg == 1, colnames(data)]\n",
    "attach(data) # make each variable as an object "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Exploratory Data Analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>'wage'</li><li>'lwage'</li><li>'sex'</li><li>'shs'</li><li>'hsg'</li><li>'scl'</li><li>'clg'</li><li>'ad'</li><li>'mw'</li><li>'so'</li><li>'we'</li><li>'ne'</li><li>'exp1'</li><li>'exp2'</li><li>'exp3'</li><li>'exp4'</li><li>'occ'</li><li>'occ2'</li><li>'ind'</li><li>'ind2'</li></ol>\n"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item 'wage'\n",
       "\\item 'lwage'\n",
       "\\item 'sex'\n",
       "\\item 'shs'\n",
       "\\item 'hsg'\n",
       "\\item 'scl'\n",
       "\\item 'clg'\n",
       "\\item 'ad'\n",
       "\\item 'mw'\n",
       "\\item 'so'\n",
       "\\item 'we'\n",
       "\\item 'ne'\n",
       "\\item 'exp1'\n",
       "\\item 'exp2'\n",
       "\\item 'exp3'\n",
       "\\item 'exp4'\n",
       "\\item 'occ'\n",
       "\\item 'occ2'\n",
       "\\item 'ind'\n",
       "\\item 'ind2'\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. 'wage'\n",
       "2. 'lwage'\n",
       "3. 'sex'\n",
       "4. 'shs'\n",
       "5. 'hsg'\n",
       "6. 'scl'\n",
       "7. 'clg'\n",
       "8. 'ad'\n",
       "9. 'mw'\n",
       "10. 'so'\n",
       "11. 'we'\n",
       "12. 'ne'\n",
       "13. 'exp1'\n",
       "14. 'exp2'\n",
       "15. 'exp3'\n",
       "16. 'exp4'\n",
       "17. 'occ'\n",
       "18. 'occ2'\n",
       "19. 'ind'\n",
       "20. 'ind2'\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       " [1] \"wage\"  \"lwage\" \"sex\"   \"shs\"   \"hsg\"   \"scl\"   \"clg\"   \"ad\"    \"mw\"   \n",
       "[10] \"so\"    \"we\"    \"ne\"    \"exp1\"  \"exp2\"  \"exp3\"  \"exp4\"  \"occ\"   \"occ2\" \n",
       "[19] \"ind\"   \"ind2\" "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "colnames(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "Plot with title \"Lorenz Curve for Higher Education Salaries\""
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "###################### Lorenz Curve for Salaries by Deciles for the subgroup of individuals who accessed higher education ######################\n",
    "# Sort wages in ascending order\n",
    "wage_sorted <- sort(wage)\n",
    "# Compute the cumulative sum of sorted wages\n",
    "cumulative_sum <- cumsum(wage_sorted)\n",
    "# Calculate the deciles of the cumulative sum of wages\n",
    "deciles <- quantile(cumulative_sum, probs = seq(0, 1, by = 0.1))\n",
    "\n",
    "# Create a vector for the cumulative fraction of the population for x-axis\n",
    "population_fraction <- seq(0, 1, by = 0.1)\n",
    "\n",
    "# Calculate the cumulative fraction of salaries\n",
    "salary_fraction <- quantile(deciles/sum(wage), probs = seq(0, 1, by = 0.1))\n",
    "\n",
    "# Plot the Lorenz curve\n",
    "plot(population_fraction, salary_fraction, type = \"l\", lwd = 2, col = \"blue\",\n",
    "     main = \"Lorenz Curve for Higher Education Salaries\",\n",
    "     xlab = \"Cumulative fraction of the population\",\n",
    "     ylab = \"Cumulative fraction of salaries\")\n",
    "abline(0, 1, lty = 2, col = \"red\")  # Equality line"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"\u001b[1m\u001b[22mUsing `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n",
      "\u001b[36mℹ\u001b[39m Please use `linewidth` instead.\"\n",
      "Warning message:\n",
      "\"\u001b[1m\u001b[22mThe dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\n",
      "\u001b[36mℹ\u001b[39m Please use `after_stat(density)` instead.\"\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "########################### Histogram for lwage ###########################\n",
    "\n",
    "ggplot(data, aes(x = lwage)) +\n",
    "  geom_histogram(aes(y = ..density..), bins = 30, fill = \"lightblue\", color = \"black\") +\n",
    "  geom_density(color = \"red\", size = 1) +\n",
    "  labs(title = \"Histogram of Salaries with Density Function\", x = \"Lwage\", y = \"Density\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"\u001b[1m\u001b[22mUse of `plot_data$proportion` is discouraged.\n",
      "\u001b[36mℹ\u001b[39m Use `proportion` instead.\"\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "############################Graph bar sex\n",
    "total_observations <- nrow(data)\n",
    "proportions <- prop.table(table(data$sex)) * 100\n",
    "plot_data <- data.frame(sex = factor(names(proportions), labels = c(\"Male\", \"Female\")), proportion = as.numeric(proportions))\n",
    "\n",
    "ggplot(plot_data, aes(x = sex, y = proportion, fill = sex)) +\n",
    "  geom_bar(stat = \"identity\") +\n",
    "  labs(title = \"Proportion of Male and Female Individuals with Higher Education\",\n",
    "       x = \"Sex (0 = Male, 1 = Female)\", y = \"Percentage\",\n",
    "       fill = \"Sex\") +\n",
    "  theme_minimal() +\n",
    "  geom_text(aes(label = paste0(round(proportion, 1), \"%\")), vjust = -0.5, size = 3) +\n",
    "  geom_text(aes(x = 1.5, y = max(plot_data$proportion) * 0.9,\n",
    "                label = paste(\"Total observations:\", total_observations)), \n",
    "            hjust = 0.5, size = 3) +\n",
    "  guides(fill = guide_legend(title = \"Sex\", reverse = TRUE))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n",
      "Attaching package: 'dplyr'\n",
      "\n",
      "\n",
      "The following objects are masked from 'package:stats':\n",
      "\n",
      "    filter, lag\n",
      "\n",
      "\n",
      "The following objects are masked from 'package:base':\n",
      "\n",
      "    intersect, setdiff, setequal, union\n",
      "\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "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IQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhLVi1dfyrZz99/spH3oHd/eh+n3JzbtHuL8Sqk59dEdLI81b98w5/PxF3uaLdX4iVEtJeR+GGGe3+Qmy7491zq+4J16r/pXrbzcNENfx9d/pqeAXV6YsORncspCreMKPdX4hV3a/tfPemvPu06p1cDU8fPIx0V3PqoqfuQP+zaMOMdn8hdhjSavjxQTir46f3v3CqucNb339v4eDaooh2fyF2LKT2Cdrq8EvN87XdmaqDkLrTjoR09C2Ew0ekow9cpYt2fyF2JKR+Bke+1D1VG1zB/kWPhXQspUE2uxhPvSdfrGB3F2rjXyN15z58iteGdOo10t5FB7d94ovRhhnt/kLseEjHntqdf+EzePp27qyEhDnadrD7OwbNL/2HnOfe/u5dz/ai+29/r1YHn/evipAA1AgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBP4/Y+GUeeV5s2kAAAAASUVORK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "########################Education Status\"Analysis of individuals who accessed higher education\"\n",
    "library(dplyr)\n",
    "library(tidyr)\n",
    "library(ggplot2)\n",
    "\n",
    "data <- data %>%\n",
    "  mutate(Education_Status = case_when(\n",
    "    scl == 1 ~ \"Some College\",\n",
    "    clg == 1 ~ \"College Graduate\",\n",
    "    ad == 1 ~ \"Advanced Degree\"\n",
    "  ))\n",
    "\n",
    "edu_freq <- data %>%\n",
    "  count(Education_Status)\n",
    "total_obs <- sum(edu_freq$n)\n",
    "edu_freq <- edu_freq %>%\n",
    "  mutate(Percentage = n / total_obs * 100)\n",
    "\n",
    "# Crear el gráfico de pastel\n",
    "ggplot(edu_freq, aes(x = \"\", y = Percentage, fill = Education_Status)) +\n",
    "  geom_bar(stat = \"identity\", width = 1) +\n",
    "  coord_polar(\"y\", start = 0) + \n",
    "  labs(title = \"Education Status Distribution\",\n",
    "       x = NULL, y = NULL,\n",
    "       fill = \"Education Status\",\n",
    "       caption = paste(\"Total observations:\", total_obs)) +\n",
    "  scale_y_continuous(labels = scales::percent_format()) +  \n",
    "  geom_text(aes(label = paste0(round(Percentage, 1), \"%\")), position = position_stack(vjust = 0.5)) + \n",
    "  theme_void() +\n",
    "  theme(legend.position = \"right\")  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#######################################Experience\n",
    "ggplot(data, aes(y = exp1)) +\n",
    "  geom_boxplot() +\n",
    "  labs(title = \"Distribution of Experience in Individuals with Higher Education\",\n",
    "       y = \"Experience (exp1)\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To start our (causal) analysis, we compare the sample means given gender:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:48.309038Z",
     "iopub.status.busy": "2021-02-21T17:17:48.279446Z",
     "iopub.status.idle": "2021-02-21T17:17:48.385996Z",
     "shell.execute_reply": "2021-02-21T17:17:48.384619Z"
    },
    "papermill": {
     "duration": 0.130992,
     "end_time": "2021-02-21T17:17:48.386138",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.255146",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Installing package into 'C:/Users/Matias Villalba/AppData/Local/R/win-library/4.3'\n",
      "(as 'lib' is unspecified)\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "package 'xtable' successfully unpacked and MD5 sums checked\n",
      "\n",
      "The downloaded binary packages are in\n",
      "\tC:\\Users\\Matias Villalba\\AppData\\Local\\Temp\\RtmpCQtUEn\\downloaded_packages\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A xtable: 12 × 3</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>All</th><th scope=col>Men</th><th scope=col>Women</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>Log Wage</th><td> 3.0627476</td><td> 3.0994485</td><td> 3.0244165</td></tr>\n",
       "\t<tr><th scope=row>Sex</th><td> 0.4891362</td><td> 0.0000000</td><td> 1.0000000</td></tr>\n",
       "\t<tr><th scope=row>Less then High School</th><td> 0.0000000</td><td> 0.0000000</td><td> 0.0000000</td></tr>\n",
       "\t<tr><th scope=row>High School Graduate</th><td> 0.0000000</td><td> 0.0000000</td><td> 0.0000000</td></tr>\n",
       "\t<tr><th scope=row>Some College</th><td> 0.3794383</td><td> 0.4056017</td><td> 0.3521127</td></tr>\n",
       "\t<tr><th scope=row>Gollage Graduate</th><td> 0.4334923</td><td> 0.4362033</td><td> 0.4306609</td></tr>\n",
       "\t<tr><th scope=row>Advanced Degree</th><td> 0.1870694</td><td> 0.1581950</td><td> 0.2172264</td></tr>\n",
       "\t<tr><th scope=row>Northeast</th><td> 0.2498675</td><td> 0.2458506</td><td> 0.2540628</td></tr>\n",
       "\t<tr><th scope=row>Midwest</th><td> 0.2983572</td><td> 0.3034232</td><td> 0.2930661</td></tr>\n",
       "\t<tr><th scope=row>South</th><td> 0.2225755</td><td> 0.2308091</td><td> 0.2139762</td></tr>\n",
       "\t<tr><th scope=row>West</th><td> 0.2291998</td><td> 0.2199170</td><td> 0.2388949</td></tr>\n",
       "\t<tr><th scope=row>Experience</th><td>12.5102014</td><td>12.2022822</td><td>12.8317985</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A xtable: 12 × 3\n",
       "\\begin{tabular}{r|lll}\n",
       "  & All & Men & Women\\\\\n",
       "  & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\tLog Wage &  3.0627476 &  3.0994485 &  3.0244165\\\\\n",
       "\tSex &  0.4891362 &  0.0000000 &  1.0000000\\\\\n",
       "\tLess then High School &  0.0000000 &  0.0000000 &  0.0000000\\\\\n",
       "\tHigh School Graduate &  0.0000000 &  0.0000000 &  0.0000000\\\\\n",
       "\tSome College &  0.3794383 &  0.4056017 &  0.3521127\\\\\n",
       "\tGollage Graduate &  0.4334923 &  0.4362033 &  0.4306609\\\\\n",
       "\tAdvanced Degree &  0.1870694 &  0.1581950 &  0.2172264\\\\\n",
       "\tNortheast &  0.2498675 &  0.2458506 &  0.2540628\\\\\n",
       "\tMidwest &  0.2983572 &  0.3034232 &  0.2930661\\\\\n",
       "\tSouth &  0.2225755 &  0.2308091 &  0.2139762\\\\\n",
       "\tWest &  0.2291998 &  0.2199170 &  0.2388949\\\\\n",
       "\tExperience & 12.5102014 & 12.2022822 & 12.8317985\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A xtable: 12 × 3\n",
       "\n",
       "| <!--/--> | All &lt;dbl&gt; | Men &lt;dbl&gt; | Women &lt;dbl&gt; |\n",
       "|---|---|---|---|\n",
       "| Log Wage |  3.0627476 |  3.0994485 |  3.0244165 |\n",
       "| Sex |  0.4891362 |  0.0000000 |  1.0000000 |\n",
       "| Less then High School |  0.0000000 |  0.0000000 |  0.0000000 |\n",
       "| High School Graduate |  0.0000000 |  0.0000000 |  0.0000000 |\n",
       "| Some College |  0.3794383 |  0.4056017 |  0.3521127 |\n",
       "| Gollage Graduate |  0.4334923 |  0.4362033 |  0.4306609 |\n",
       "| Advanced Degree |  0.1870694 |  0.1581950 |  0.2172264 |\n",
       "| Northeast |  0.2498675 |  0.2458506 |  0.2540628 |\n",
       "| Midwest |  0.2983572 |  0.3034232 |  0.2930661 |\n",
       "| South |  0.2225755 |  0.2308091 |  0.2139762 |\n",
       "| West |  0.2291998 |  0.2199170 |  0.2388949 |\n",
       "| Experience | 12.5102014 | 12.2022822 | 12.8317985 |\n",
       "\n"
      ],
      "text/plain": [
       "                      All        Men        Women     \n",
       "Log Wage               3.0627476  3.0994485  3.0244165\n",
       "Sex                    0.4891362  0.0000000  1.0000000\n",
       "Less then High School  0.0000000  0.0000000  0.0000000\n",
       "High School Graduate   0.0000000  0.0000000  0.0000000\n",
       "Some College           0.3794383  0.4056017  0.3521127\n",
       "Gollage Graduate       0.4334923  0.4362033  0.4306609\n",
       "Advanced Degree        0.1870694  0.1581950  0.2172264\n",
       "Northeast              0.2498675  0.2458506  0.2540628\n",
       "Midwest                0.2983572  0.3034232  0.2930661\n",
       "South                  0.2225755  0.2308091  0.2139762\n",
       "West                   0.2291998  0.2199170  0.2388949\n",
       "Experience            12.5102014 12.2022822 12.8317985"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "install.packages(\"xtable\")\n",
    "library(xtable)\n",
    "\n",
    "Z <- data[which(colnames(data) %in% c(\"lwage\",\"sex\",\"shs\",\"hsg\",\"scl\",\"clg\",\"ad\",\"ne\",\"mw\",\"so\",\"we\",\"exp1\"))]\n",
    "\n",
    "data_female <- data[data$sex==1,]\n",
    "Z_female <- data_female[which(colnames(data) %in% c(\"lwage\",\"sex\",\"shs\",\"hsg\",\"scl\",\"clg\",\"ad\",\"ne\",\"mw\",\"so\",\"we\",\"exp1\"))]\n",
    "\n",
    "\n",
    "data_male <- data[data$sex==0,]\n",
    "Z_male <- data_male[which(colnames(data) %in% c(\"lwage\",\"sex\",\"shs\",\"hsg\",\"scl\",\"clg\",\"ad\",\"ne\",\"mw\",\"so\",\"we\",\"exp1\"))]\n",
    "\n",
    "table <- matrix(0, 12, 3)\n",
    "table[1:12,1]   <- as.numeric(lapply(Z,mean))\n",
    "table[1:12,2]   <- as.numeric(lapply(Z_male,mean))\n",
    "table[1:12,3]   <- as.numeric(lapply(Z_female,mean))\n",
    "rownames(table) <- c(\"Log Wage\",\"Sex\",\"Less then High School\",\"High School Graduate\",\"Some College\",\"Gollage Graduate\",\"Advanced Degree\", \"Northeast\",\"Midwest\",\"South\",\"West\",\"Experience\")\n",
    "colnames(table) <- c(\"All\",\"Men\",\"Women\")\n",
    "tab<- xtable(table, digits = 4)\n",
    "tab"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:48.431654Z",
     "iopub.status.busy": "2021-02-21T17:17:48.430537Z",
     "iopub.status.idle": "2021-02-21T17:17:48.450210Z",
     "shell.execute_reply": "2021-02-21T17:17:48.448493Z"
    },
    "papermill": {
     "duration": 0.044113,
     "end_time": "2021-02-21T17:17:48.450550",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.406437",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<!-- html table generated in R 4.3.3 by xtable 1.8-4 package -->\n",
      "<!-- Sat Apr 13 20:46:24 2024 -->\n",
      "<table border=1>\n",
      "<tr> <th>  </th> <th> All </th> <th> Men </th> <th> Women </th>  </tr>\n",
      "  <tr> <td align=\"right\"> Log Wage </td> <td align=\"right\"> 3.0627 </td> <td align=\"right\"> 3.0994 </td> <td align=\"right\"> 3.0244 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Sex </td> <td align=\"right\"> 0.4891 </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 1.0000 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Less then High School </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> </tr>\n",
      "  <tr> <td align=\"right\"> High School Graduate </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Some College </td> <td align=\"right\"> 0.3794 </td> <td align=\"right\"> 0.4056 </td> <td align=\"right\"> 0.3521 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Gollage Graduate </td> <td align=\"right\"> 0.4335 </td> <td align=\"right\"> 0.4362 </td> <td align=\"right\"> 0.4307 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Advanced Degree </td> <td align=\"right\"> 0.1871 </td> <td align=\"right\"> 0.1582 </td> <td align=\"right\"> 0.2172 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Northeast </td> <td align=\"right\"> 0.2499 </td> <td align=\"right\"> 0.2459 </td> <td align=\"right\"> 0.2541 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Midwest </td> <td align=\"right\"> 0.2984 </td> <td align=\"right\"> 0.3034 </td> <td align=\"right\"> 0.2931 </td> </tr>\n",
      "  <tr> <td align=\"right\"> South </td> <td align=\"right\"> 0.2226 </td> <td align=\"right\"> 0.2308 </td> <td align=\"right\"> 0.2140 </td> </tr>\n",
      "  <tr> <td align=\"right\"> West </td> <td align=\"right\"> 0.2292 </td> <td align=\"right\"> 0.2199 </td> <td align=\"right\"> 0.2389 </td> </tr>\n",
      "  <tr> <td align=\"right\"> Experience </td> <td align=\"right\"> 12.5102 </td> <td align=\"right\"> 12.2023 </td> <td align=\"right\"> 12.8318 </td> </tr>\n",
      "   </table>\n"
     ]
    }
   ],
   "source": [
    "print(tab,type=\"html\") # set type=\"latex\" for printing table in LaTeX"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.020063,
     "end_time": "2021-02-21T17:17:48.491517",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.471454",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<!-- html table generated in R 4.3.3 by xtable 1.8-4 package -->\n",
    "<!-- Sat Apr 13 20:46:24 2024 -->\n",
    "<table border=1>\n",
    "<tr> <th>  </th> <th> All </th> <th> Men </th> <th> Women </th>  </tr>\n",
    "  <tr> <td align=\"right\"> Log Wage </td> <td align=\"right\"> 3.0627 </td> <td align=\"right\"> 3.0994 </td> <td align=\"right\"> 3.0244 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Sex </td> <td align=\"right\"> 0.4891 </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 1.0000 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Less then High School </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> </tr>\n",
    "  <tr> <td align=\"right\"> High School Graduate </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> <td align=\"right\"> 0.0000 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Some College </td> <td align=\"right\"> 0.3794 </td> <td align=\"right\"> 0.4056 </td> <td align=\"right\"> 0.3521 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Gollage Graduate </td> <td align=\"right\"> 0.4335 </td> <td align=\"right\"> 0.4362 </td> <td align=\"right\"> 0.4307 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Advanced Degree </td> <td align=\"right\"> 0.1871 </td> <td align=\"right\"> 0.1582 </td> <td align=\"right\"> 0.2172 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Northeast </td> <td align=\"right\"> 0.2499 </td> <td align=\"right\"> 0.2459 </td> <td align=\"right\"> 0.2541 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Midwest </td> <td align=\"right\"> 0.2984 </td> <td align=\"right\"> 0.3034 </td> <td align=\"right\"> 0.2931 </td> </tr>\n",
    "  <tr> <td align=\"right\"> South </td> <td align=\"right\"> 0.2226 </td> <td align=\"right\"> 0.2308 </td> <td align=\"right\"> 0.2140 </td> </tr>\n",
    "  <tr> <td align=\"right\"> West </td> <td align=\"right\"> 0.2292 </td> <td align=\"right\"> 0.2199 </td> <td align=\"right\"> 0.2389 </td> </tr>\n",
    "  <tr> <td align=\"right\"> Experience </td> <td align=\"right\"> 12.5102 </td> <td align=\"right\"> 12.2023 </td> <td align=\"right\"> 12.8318 </td> </tr>\n",
    "   </table>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.020634,
     "end_time": "2021-02-21T17:17:48.532828",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.512194",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "In particular, the table above shows that the difference in average *logwage* between men and women is equal to $0,075$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:48.578674Z",
     "iopub.status.busy": "2021-02-21T17:17:48.577061Z",
     "iopub.status.idle": "2021-02-21T17:17:48.591063Z",
     "shell.execute_reply": "2021-02-21T17:17:48.589749Z"
    },
    "papermill": {
     "duration": 0.037974,
     "end_time": "2021-02-21T17:17:48.591228",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.553254",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "-0.0750320051259581"
      ],
      "text/latex": [
       "-0.0750320051259581"
      ],
      "text/markdown": [
       "-0.0750320051259581"
      ],
      "text/plain": [
       "[1] -0.07503201"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "mean(data_female$lwage)-mean(data_male$lwage)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.022161,
     "end_time": "2021-02-21T17:17:48.635417",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.613256",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Thus, the unconditional gender wage gap is about $7,5$\\% for the group of never married workers (women get paid less on average in our sample). We also observe that never married working women are relatively more educated than working men and have lower working experience."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.02073,
     "end_time": "2021-02-21T17:17:48.677447",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.656717",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "This unconditional (predictive) effect of gender equals the coefficient $\\beta$ in the univariate ols regression of $Y$ on $D$:\n",
    "\n",
    "\\begin{align}\n",
    "\\log(Y) &=\\beta D + \\epsilon.\n",
    "\\end{align}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.020929,
     "end_time": "2021-02-21T17:17:48.718630",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.697701",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We verify this by running an ols regression in R."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:48.766832Z",
     "iopub.status.busy": "2021-02-21T17:17:48.765704Z",
     "iopub.status.idle": "2021-02-21T17:17:48.946342Z",
     "shell.execute_reply": "2021-02-21T17:17:48.944941Z"
    },
    "papermill": {
     "duration": 0.205828,
     "end_time": "2021-02-21T17:17:48.946508",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.740680",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The estimated gender coefficient is -0.07503201  and the corresponding robust standard error is 0.0183426"
     ]
    }
   ],
   "source": [
    "#install.packages(\"sandwich\")\n",
    "library(sandwich)\n",
    "\n",
    "nocontrol.fit <- lm(lwage ~ sex, data = data)\n",
    "nocontrol.est <- summary(nocontrol.fit)$coef[\"sex\",1]\n",
    "HCV.coefs <- vcovHC(nocontrol.fit, type = 'HC');\n",
    "nocontrol.se <- sqrt(diag(HCV.coefs))[2] # Estimated std errors\n",
    "\n",
    "# print unconditional effect of gender and the corresponding standard error\n",
    "cat (\"The estimated gender coefficient is\",nocontrol.est,\" and the corresponding robust standard error is\",nocontrol.se) \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.02196,
     "end_time": "2021-02-21T17:17:48.991015",
     "exception": false,
     "start_time": "2021-02-21T17:17:48.969055",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Note that the standard error is computed with the *R* package *sandwich* to be robust to heteroskedasticity. \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.021605,
     "end_time": "2021-02-21T17:17:49.034485",
     "exception": false,
     "start_time": "2021-02-21T17:17:49.012880",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Next, we run an ols regression of $Y$ on $(D,W)$ to control for the effect of covariates summarized in $W$:\n",
    "\n",
    "\\begin{align}\n",
    "\\log(Y) &=\\beta_1 D  + \\beta_2' W + \\epsilon.\n",
    "\\end{align}\n",
    "\n",
    "Here, we are considering the flexible model from the previous lab. Hence, $W$ controls for experience, education, region, and occupation and industry indicators plus transformations and two-way interactions."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.021109,
     "end_time": "2021-02-21T17:17:49.076809",
     "exception": false,
     "start_time": "2021-02-21T17:17:49.055700",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Let us run the ols regression with controls."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:49.124867Z",
     "iopub.status.busy": "2021-02-21T17:17:49.123217Z",
     "iopub.status.idle": "2021-02-21T17:17:49.792247Z",
     "shell.execute_reply": "2021-02-21T17:17:49.790841Z"
    },
    "papermill": {
     "duration": 0.694579,
     "end_time": "2021-02-21T17:17:49.792415",
     "exception": false,
     "start_time": "2021-02-21T17:17:49.097836",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "lm(formula = flex, data = data)\n",
       "\n",
       "Residuals:\n",
       "     Min       1Q   Median       3Q      Max \n",
       "-1.88469 -0.28018 -0.00257  0.27071  2.87358 \n",
       "\n",
       "Coefficients: (11 not defined because of singularities)\n",
       "             Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)  3.880838   0.463424   8.374  < 2e-16 ***\n",
       "sex         -0.067634   0.017476  -3.870 0.000111 ***\n",
       "exp1        -0.108571   0.182969  -0.593 0.552963    \n",
       "exp2         2.760461   2.185329   1.263 0.206608    \n",
       "exp3        -1.557529   0.928441  -1.678 0.093518 .  \n",
       "exp4         0.245175   0.125503   1.954 0.050834 .  \n",
       "shs                NA         NA      NA       NA    \n",
       "hsg                NA         NA      NA       NA    \n",
       "scl         -0.268071   0.128942  -2.079 0.037689 *  \n",
       "clg         -0.044201   0.071314  -0.620 0.535423    \n",
       "occ22        0.148912   0.134319   1.109 0.267660    \n",
       "occ23        0.151683   0.173250   0.876 0.381353    \n",
       "occ24        0.024109   0.189196   0.127 0.898608    \n",
       "occ25       -0.435165   0.197117  -2.208 0.027333 *  \n",
       "occ26       -0.220077   0.195436  -1.126 0.260207    \n",
       "occ27        0.283226   0.198407   1.427 0.153525    \n",
       "occ28       -0.224300   0.174748  -1.284 0.199380    \n",
       "occ29       -0.331892   0.172040  -1.929 0.053792 .  \n",
       "occ210       0.009382   0.166232   0.056 0.954997    \n",
       "occ211      -0.574719   0.340497  -1.688 0.091522 .  \n",
       "occ212      -0.132992   0.265391  -0.501 0.616320    \n",
       "occ213      -0.267986   0.251119  -1.067 0.285968    \n",
       "occ214       0.230008   0.373618   0.616 0.538182    \n",
       "occ215      -0.172214   0.276890  -0.622 0.534008    \n",
       "occ216      -0.124377   0.154234  -0.806 0.420058    \n",
       "occ217      -0.430457   0.144865  -2.971 0.002984 ** \n",
       "occ218      -0.186069   2.225178  -0.084 0.933364    \n",
       "occ219      -0.081721   0.392145  -0.208 0.834932    \n",
       "occ220      -0.454853   0.259208  -1.755 0.079383 .  \n",
       "occ221      -0.809969   0.254915  -3.177 0.001499 ** \n",
       "occ222      -0.815933   0.360786  -2.262 0.023786 *  \n",
       "ind23       -1.089541   0.743919  -1.465 0.143120    \n",
       "ind24        0.044558   0.502874   0.089 0.929399    \n",
       "ind25       -0.547942   0.471498  -1.162 0.245261    \n",
       "ind26       -0.718493   0.472438  -1.521 0.128394    \n",
       "ind27       -0.408055   0.537482  -0.759 0.447785    \n",
       "ind28       -0.661250   0.515152  -1.284 0.199365    \n",
       "ind29       -0.756120   0.461846  -1.637 0.101684    \n",
       "ind210      -0.529993   0.531342  -0.997 0.318608    \n",
       "ind211      -0.972449   0.482059  -2.017 0.043741 *  \n",
       "ind212      -0.729268   0.458956  -1.589 0.112156    \n",
       "ind213      -0.998945   0.516806  -1.933 0.053326 .  \n",
       "ind214      -0.612478   0.450779  -1.359 0.174325    \n",
       "ind215      -0.543112   0.631890  -0.860 0.390121    \n",
       "ind216      -0.553484   0.476666  -1.161 0.245657    \n",
       "ind217      -0.838034   0.460336  -1.820 0.068770 .  \n",
       "ind218      -0.791949   0.459071  -1.725 0.084594 .  \n",
       "ind219      -0.928112   0.490880  -1.891 0.058745 .  \n",
       "ind220      -0.899239   0.484704  -1.855 0.063646 .  \n",
       "ind221      -0.777590   0.475908  -1.634 0.102368    \n",
       "ind222      -0.443536   0.467122  -0.950 0.342427    \n",
       "mw           0.140500   0.086958   1.616 0.106244    \n",
       "so           0.026207   0.079301   0.330 0.741058    \n",
       "we           0.048288   0.088297   0.547 0.584493    \n",
       "exp1:shs           NA         NA      NA       NA    \n",
       "exp1:hsg           NA         NA      NA       NA    \n",
       "exp1:scl    -0.071528   0.044794  -1.597 0.110395    \n",
       "exp1:clg    -0.052510   0.031659  -1.659 0.097290 .  \n",
       "exp1:occ22  -0.066435   0.053768  -1.236 0.216692    \n",
       "exp1:occ23  -0.039714   0.067203  -0.591 0.554593    \n",
       "exp1:occ24  -0.044148   0.080037  -0.552 0.581264    \n",
       "exp1:occ25   0.130869   0.090981   1.438 0.150402    \n",
       "exp1:occ26  -0.036843   0.079519  -0.463 0.643162    \n",
       "exp1:occ27  -0.217129   0.081806  -2.654 0.007986 ** \n",
       "exp1:occ28  -0.043218   0.069581  -0.621 0.534564    \n",
       "exp1:occ29   0.020649   0.071375   0.289 0.772366    \n",
       "exp1:occ210  0.014178   0.066700   0.213 0.831675    \n",
       "exp1:occ211  0.037333   0.126451   0.295 0.767830    \n",
       "exp1:occ212 -0.055604   0.100191  -0.555 0.578947    \n",
       "exp1:occ213  0.041249   0.091958   0.449 0.653774    \n",
       "exp1:occ214 -0.119023   0.133471  -0.892 0.372585    \n",
       "exp1:occ215 -0.066657   0.103520  -0.644 0.519678    \n",
       "exp1:occ216 -0.020584   0.058149  -0.354 0.723375    \n",
       "exp1:occ217  0.021233   0.053788   0.395 0.693043    \n",
       "exp1:occ218 -0.066422   1.110702  -0.060 0.952317    \n",
       "exp1:occ219 -0.073559   0.135324  -0.544 0.586763    \n",
       "exp1:occ220  0.079898   0.090445   0.883 0.377082    \n",
       "exp1:occ221  0.270508   0.091179   2.967 0.003030 ** \n",
       "exp1:occ222  0.077255   0.120728   0.640 0.522271    \n",
       "exp1:ind23   0.434498   0.300512   1.446 0.148306    \n",
       "exp1:ind24   0.004614   0.190028   0.024 0.980629    \n",
       "exp1:ind25   0.178890   0.187530   0.954 0.340186    \n",
       "exp1:ind26   0.234188   0.185514   1.262 0.206897    \n",
       "exp1:ind27   0.095699   0.212425   0.451 0.652373    \n",
       "exp1:ind28   0.223093   0.216341   1.031 0.302512    \n",
       "exp1:ind29   0.147902   0.181455   0.815 0.415077    \n",
       "exp1:ind210  0.154391   0.204641   0.754 0.450630    \n",
       "exp1:ind211  0.329852   0.189314   1.742 0.081533 .  \n",
       "exp1:ind212  0.287189   0.182027   1.578 0.114717    \n",
       "exp1:ind213  0.360734   0.197746   1.824 0.068201 .  \n",
       "exp1:ind214  0.188209   0.178995   1.051 0.293114    \n",
       "exp1:ind215  0.112956   0.282951   0.399 0.689764    \n",
       "exp1:ind216  0.104720   0.189077   0.554 0.579716    \n",
       "exp1:ind217  0.206963   0.182375   1.135 0.256526    \n",
       "exp1:ind218  0.204515   0.181267   1.128 0.259291    \n",
       "exp1:ind219  0.199490   0.192716   1.035 0.300669    \n",
       "exp1:ind220  0.152476   0.189062   0.806 0.420018    \n",
       "exp1:ind221  0.250721   0.186934   1.341 0.179932    \n",
       "exp1:ind222  0.163191   0.183004   0.892 0.372597    \n",
       "exp1:mw     -0.047600   0.035164  -1.354 0.175932    \n",
       "exp1:so     -0.013572   0.031634  -0.429 0.667917    \n",
       "exp1:we     -0.036068   0.034310  -1.051 0.293222    \n",
       "exp2:shs           NA         NA      NA       NA    \n",
       "exp2:hsg           NA         NA      NA       NA    \n",
       "exp2:scl     0.687115   0.481881   1.426 0.153985    \n",
       "exp2:clg     0.402346   0.390598   1.030 0.303044    \n",
       "exp2:occ22   0.527094   0.609392   0.865 0.387125    \n",
       "exp2:occ23   0.225955   0.762662   0.296 0.767040    \n",
       "exp2:occ24   0.609598   0.948693   0.643 0.520547    \n",
       "exp2:occ25  -1.603297   1.212946  -1.322 0.186313    \n",
       "exp2:occ26   0.064776   0.949165   0.068 0.945594    \n",
       "exp2:occ27   3.099522   0.997912   3.106 0.001911 ** \n",
       "exp2:occ28   0.260534   0.797301   0.327 0.743861    \n",
       "exp2:occ29   0.172604   0.829760   0.208 0.835228    \n",
       "exp2:occ210 -0.349280   0.775901  -0.450 0.652622    \n",
       "exp2:occ211 -0.145738   1.423343  -0.102 0.918452    \n",
       "exp2:occ212  0.424348   1.149393   0.369 0.712006    \n",
       "exp2:occ213 -0.742081   0.992571  -0.748 0.454730    \n",
       "exp2:occ214  0.265853   1.401494   0.190 0.849561    \n",
       "exp2:occ215  0.338227   1.128005   0.300 0.764313    \n",
       "exp2:occ216 -0.001585   0.642063  -0.002 0.998030    \n",
       "exp2:occ217 -0.353390   0.589074  -0.600 0.548606    \n",
       "exp2:occ218 -0.038852   9.385632  -0.004 0.996697    \n",
       "exp2:occ219  0.972485   1.399603   0.695 0.487208    \n",
       "exp2:occ220 -0.726862   0.934768  -0.778 0.436865    \n",
       "exp2:occ221 -3.285748   0.977012  -3.363 0.000779 ***\n",
       "exp2:occ222 -0.456725   1.212919  -0.377 0.706530    \n",
       "exp2:ind23  -5.824070   3.732976  -1.560 0.118810    \n",
       "exp2:ind24  -1.889540   2.229469  -0.848 0.396757    \n",
       "exp2:ind25  -3.397191   2.238534  -1.518 0.129206    \n",
       "exp2:ind26  -3.761806   2.205929  -1.705 0.088223 .  \n",
       "exp2:ind27  -2.099423   2.555966  -0.821 0.411484    \n",
       "exp2:ind28  -3.028965   2.733447  -1.108 0.267889    \n",
       "exp2:ind29  -2.788142   2.167615  -1.286 0.198432    \n",
       "exp2:ind210 -2.990458   2.369136  -1.262 0.206939    \n",
       "exp2:ind211 -4.732148   2.248906  -2.104 0.035431 *  \n",
       "exp2:ind212 -4.133344   2.180238  -1.896 0.058065 .  \n",
       "exp2:ind213 -4.917856   2.310394  -2.129 0.033358 *  \n",
       "exp2:ind214 -3.257135   2.150783  -1.514 0.130015    \n",
       "exp2:ind215 -2.291289   3.277340  -0.699 0.484516    \n",
       "exp2:ind216 -2.200558   2.256437  -0.975 0.329510    \n",
       "exp2:ind217 -3.236968   2.184221  -1.482 0.138435    \n",
       "exp2:ind218 -3.472941   2.170142  -1.600 0.109615    \n",
       "exp2:ind219 -3.089987   2.273999  -1.359 0.174286    \n",
       "exp2:ind220 -2.877686   2.236664  -1.287 0.198319    \n",
       "exp2:ind221 -3.985898   2.224415  -1.792 0.073237 .  \n",
       "exp2:ind222 -3.054599   2.178721  -1.402 0.160999    \n",
       "exp2:mw      0.405157   0.404326   1.002 0.316386    \n",
       "exp2:so      0.169620   0.359140   0.472 0.636745    \n",
       "exp2:we      0.566872   0.383896   1.477 0.139864    \n",
       "exp3:shs           NA         NA      NA       NA    \n",
       "exp3:hsg           NA         NA      NA       NA    \n",
       "exp3:scl    -0.225675   0.194444  -1.161 0.245877    \n",
       "exp3:clg    -0.105850   0.169919  -0.623 0.533362    \n",
       "exp3:occ22  -0.127358   0.250141  -0.509 0.610682    \n",
       "exp3:occ23  -0.050120   0.313891  -0.160 0.873148    \n",
       "exp3:occ24  -0.284498   0.394622  -0.721 0.470995    \n",
       "exp3:occ25   0.714085   0.554332   1.288 0.197764    \n",
       "exp3:occ26   0.078209   0.410734   0.190 0.848996    \n",
       "exp3:occ27  -1.394062   0.438136  -3.182 0.001476 ** \n",
       "exp3:occ28  -0.009171   0.328256  -0.028 0.977714    \n",
       "exp3:occ29  -0.158800   0.345751  -0.459 0.646054    \n",
       "exp3:occ210  0.233391   0.326016   0.716 0.474107    \n",
       "exp3:occ211 -0.034816   0.598743  -0.058 0.953634    \n",
       "exp3:occ212  0.017275   0.479540   0.036 0.971265    \n",
       "exp3:occ213  0.342360   0.389837   0.878 0.379888    \n",
       "exp3:occ214  0.144255   0.526802   0.274 0.784230    \n",
       "exp3:occ215  0.007181   0.451462   0.016 0.987310    \n",
       "exp3:occ216  0.104163   0.260350   0.400 0.689117    \n",
       "exp3:occ217  0.188664   0.237170   0.795 0.426388    \n",
       "exp3:occ218  0.081058   1.827773   0.044 0.964629    \n",
       "exp3:occ219 -0.430058   0.540351  -0.796 0.426151    \n",
       "exp3:occ220  0.246731   0.361135   0.683 0.494518    \n",
       "exp3:occ221  1.334641   0.386355   3.454 0.000558 ***\n",
       "exp3:occ222  0.126481   0.458203   0.276 0.782535    \n",
       "exp3:ind23   2.678306   1.724974   1.553 0.120593    \n",
       "exp3:ind24   1.298272   0.937883   1.384 0.166367    \n",
       "exp3:ind25   1.760362   0.948790   1.855 0.063626 .  \n",
       "exp3:ind26   1.868851   0.933498   2.002 0.045362 *  \n",
       "exp3:ind27   1.174466   1.101602   1.066 0.286431    \n",
       "exp3:ind28   1.234915   1.248416   0.989 0.322640    \n",
       "exp3:ind29   1.468577   0.921405   1.594 0.111060    \n",
       "exp3:ind210  1.575305   0.987705   1.595 0.110821    \n",
       "exp3:ind211  2.233491   0.952335   2.345 0.019068 *  \n",
       "exp3:ind212  1.939677   0.927217   2.092 0.036516 *  \n",
       "exp3:ind213  2.222883   0.968253   2.296 0.021747 *  \n",
       "exp3:ind214  1.673783   0.916531   1.826 0.067902 .  \n",
       "exp3:ind215  1.289902   1.319644   0.977 0.328407    \n",
       "exp3:ind216  1.252572   0.955306   1.311 0.189884    \n",
       "exp3:ind217  1.595382   0.928153   1.719 0.085724 .  \n",
       "exp3:ind218  1.762369   0.923761   1.908 0.056495 .  \n",
       "exp3:ind219  1.526045   0.958381   1.592 0.111403    \n",
       "exp3:ind220  1.527794   0.943682   1.619 0.105543    \n",
       "exp3:ind221  1.936016   0.942996   2.053 0.040141 *  \n",
       "exp3:ind222  1.610296   0.923435   1.744 0.081279 .  \n",
       "exp3:mw     -0.127201   0.168242  -0.756 0.449664    \n",
       "exp3:so     -0.063505   0.147260  -0.431 0.666318    \n",
       "exp3:we     -0.253221   0.155667  -1.627 0.103893    \n",
       "exp4:shs           NA         NA      NA       NA    \n",
       "exp4:hsg           NA         NA      NA       NA    \n",
       "exp4:scl     0.024112   0.025867   0.932 0.351324    \n",
       "exp4:clg     0.008900   0.023652   0.376 0.706728    \n",
       "exp4:occ22   0.005612   0.033502   0.168 0.866982    \n",
       "exp4:occ23   0.003462   0.041930   0.083 0.934193    \n",
       "exp4:occ24   0.037319   0.052491   0.711 0.477148    \n",
       "exp4:occ25  -0.102265   0.080051  -1.277 0.201511    \n",
       "exp4:occ26  -0.021559   0.057425  -0.375 0.707360    \n",
       "exp4:occ27   0.191216   0.061456   3.111 0.001877 ** \n",
       "exp4:occ28  -0.009269   0.043780  -0.212 0.832338    \n",
       "exp4:occ29   0.027119   0.046596   0.582 0.560597    \n",
       "exp4:occ210 -0.042185   0.044457  -0.949 0.342732    \n",
       "exp4:occ211  0.013254   0.082312   0.161 0.872089    \n",
       "exp4:occ212 -0.030339   0.065220  -0.465 0.641828    \n",
       "exp4:occ213 -0.049296   0.049838  -0.989 0.322675    \n",
       "exp4:occ214 -0.040130   0.064519  -0.622 0.533992    \n",
       "exp4:occ215 -0.015901   0.059245  -0.268 0.788415    \n",
       "exp4:occ216 -0.026793   0.034541  -0.776 0.437990    \n",
       "exp4:occ217 -0.030840   0.031263  -0.986 0.323972    \n",
       "exp4:occ218        NA         NA      NA       NA    \n",
       "exp4:occ219  0.056633   0.068595   0.826 0.409075    \n",
       "exp4:occ220 -0.029161   0.046086  -0.633 0.526935    \n",
       "exp4:occ221 -0.173879   0.050263  -3.459 0.000548 ***\n",
       "exp4:occ222 -0.015582   0.057468  -0.271 0.786293    \n",
       "exp4:ind23  -0.390159   0.263692  -1.480 0.139069    \n",
       "exp4:ind24  -0.218162   0.125715  -1.735 0.082764 .  \n",
       "exp4:ind25  -0.263027   0.128018  -2.055 0.039990 *  \n",
       "exp4:ind26  -0.274877   0.125734  -2.186 0.028868 *  \n",
       "exp4:ind27  -0.181914   0.151703  -1.199 0.230553    \n",
       "exp4:ind28  -0.149228   0.183833  -0.812 0.416987    \n",
       "exp4:ind29  -0.222289   0.124579  -1.784 0.074458 .  \n",
       "exp4:ind210 -0.237585   0.132035  -1.799 0.072039 .  \n",
       "exp4:ind211 -0.322195   0.128532  -2.507 0.012230 *  \n",
       "exp4:ind212 -0.277952   0.125403  -2.216 0.026723 *  \n",
       "exp4:ind213 -0.311492   0.129616  -2.403 0.016304 *  \n",
       "exp4:ind214 -0.250871   0.124081  -2.022 0.043268 *  \n",
       "exp4:ind215 -0.204839   0.170066  -1.204 0.228488    \n",
       "exp4:ind216 -0.199306   0.128748  -1.548 0.121703    \n",
       "exp4:ind217 -0.234727   0.125392  -1.872 0.061297 .  \n",
       "exp4:ind218 -0.262904   0.125149  -2.101 0.035735 *  \n",
       "exp4:ind219 -0.224314   0.128925  -1.740 0.081968 .  \n",
       "exp4:ind220 -0.235229   0.126946  -1.853 0.063968 .  \n",
       "exp4:ind221 -0.281403   0.127276  -2.211 0.027102 *  \n",
       "exp4:ind222 -0.246069   0.124575  -1.975 0.048315 *  \n",
       "exp4:mw      0.012197   0.022784   0.535 0.592452    \n",
       "exp4:so      0.006360   0.019596   0.325 0.745551    \n",
       "exp4:we      0.033250   0.020541   1.619 0.105598    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "Residual standard error: 0.4726 on 3539 degrees of freedom\n",
       "Multiple R-squared:  0.3447,\tAdjusted R-squared:  0.3013 \n",
       "F-statistic: 7.954 on 234 and 3539 DF,  p-value: < 2.2e-16\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Coefficient for OLS with controls -0.0676339"
     ]
    }
   ],
   "source": [
    "# Ols regression with controls\n",
    "\n",
    "flex <- lwage ~ sex + (exp1+exp2+exp3+exp4)*(shs+hsg+scl+clg+occ2+ind2+mw+so+we)\n",
    "\n",
    "#   Note that ()*() operation in formula objects in R creates a formula of the sort:\n",
    "#  (exp1+exp2+exp3+exp4)+ (shs+hsg+scl+clg+occ2+ind2+mw+so+we) +  (exp1+exp2+exp3+exp4)*(shs+hsg+scl+clg+occ2+ind2+mw+so+we)\n",
    "#  This is not intuitive at all, but that's what it does.\n",
    "\n",
    "control.fit <- lm(flex, data=data)\n",
    "control.est <- summary(control.fit)$coef[2,1]\n",
    "\n",
    "summary(control.fit)\n",
    "\n",
    "cat(\"Coefficient for OLS with controls\", control.est)\n",
    "\n",
    "HCV.coefs <- vcovHC(control.fit, type = 'HC');\n",
    "control.se <- sqrt(diag(HCV.coefs))[2] # Estimated std errors"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.040523,
     "end_time": "2021-02-21T17:17:49.873210",
     "exception": false,
     "start_time": "2021-02-21T17:17:49.832687",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "The estimated regression coefficient $\\beta_1\\approx-0.0676$ measures how our linear prediction of wage changes if we set the gender variable $D$ from 0 to 1, holding the controls $W$ fixed.\n",
    "We can call this the *predictive effect* (PE), as it measures the impact of a variable on the prediction we make. Overall, we see that the unconditional wage gap of size $4$\\% for women increases to about $7$\\% after controlling for worker characteristics.  \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.023222,
     "end_time": "2021-02-21T17:17:49.931749",
     "exception": false,
     "start_time": "2021-02-21T17:17:49.908527",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Next, we are using the Frisch-Waugh-Lovell theorem from the lecture partialling-out the linear effect of the controls via ols."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:49.985297Z",
     "iopub.status.busy": "2021-02-21T17:17:49.983529Z",
     "iopub.status.idle": "2021-02-21T17:17:50.409345Z",
     "shell.execute_reply": "2021-02-21T17:17:50.407916Z"
    },
    "papermill": {
     "duration": 0.454504,
     "end_time": "2021-02-21T17:17:50.409522",
     "exception": false,
     "start_time": "2021-02-21T17:17:49.955018",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Coefficient for D via partialling-out -0.0676339"
     ]
    },
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".dl-inline {width: auto; margin:0; padding: 0}\n",
       ".dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}\n",
       ".dl-inline>dt::after {content: \":\\0020\"; padding-right: .5ex}\n",
       ".dl-inline>dt:not(:first-of-type) {padding-left: .5ex}\n",
       "</style><dl class=dl-inline><dt>2.5 %</dt><dd>-0.100823033855121</dd><dt>97.5 %</dt><dd>-0.0344447624332549</dd></dl>\n"
      ],
      "text/latex": [
       "\\begin{description*}\n",
       "\\item[2.5 \\textbackslash{}\\%] -0.100823033855121\n",
       "\\item[97.5 \\textbackslash{}\\%] -0.0344447624332549\n",
       "\\end{description*}\n"
      ],
      "text/markdown": [
       "2.5 %\n",
       ":   -0.10082303385512197.5 %\n",
       ":   -0.0344447624332549\n",
       "\n"
      ],
      "text/plain": [
       "      2.5 %      97.5 % \n",
       "-0.10082303 -0.03444476 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Partialling-Out using ols\n",
    "\n",
    "# models\n",
    "flex.y <- lwage ~  (exp1+exp2+exp3+exp4)*(shs+hsg+scl+clg+occ2+ind2+mw+so+we) # model for Y\n",
    "flex.d <- sex ~ (exp1+exp2+exp3+exp4)*(shs+hsg+scl+clg+occ2+ind2+mw+so+we) # model for D\n",
    "\n",
    "# partialling-out the linear effect of W from Y\n",
    "t.Y <- lm(flex.y, data=data)$res\n",
    "# partialling-out the linear effect of W from D\n",
    "t.D <- lm(flex.d, data=data)$res\n",
    "\n",
    "# regression of Y on D after partialling-out the effect of W\n",
    "partial.fit <- lm(t.Y~t.D)\n",
    "partial.est <- summary(partial.fit)$coef[2,1]\n",
    "\n",
    "cat(\"Coefficient for D via partialling-out\", partial.est)\n",
    "\n",
    "# standard error\n",
    "HCV.coefs <- vcovHC(partial.fit, type = 'HC')\n",
    "partial.se <- sqrt(diag(HCV.coefs))[2]\n",
    "\n",
    "# confidence interval\n",
    "confint(partial.fit)[2,]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.023907,
     "end_time": "2021-02-21T17:17:50.458203",
     "exception": false,
     "start_time": "2021-02-21T17:17:50.434296",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Again, the estimated coefficient measures the linear predictive effect (PE) of $D$ on $Y$ after taking out the linear effect of $W$ on both of these variables. This coefficient equals the estimated coefficient from the ols regression with controls."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.024507,
     "end_time": "2021-02-21T17:17:50.507023",
     "exception": false,
     "start_time": "2021-02-21T17:17:50.482516",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We know that the partialling-out approach works well when the dimension of $W$ is low\n",
    "in relation to the sample size $n$. When the dimension of $W$ is relatively high, we need to use variable selection\n",
    "or penalization for regularization purposes. \n",
    "\n",
    "In the following, we illustrate the partialling-out approach using lasso instead of ols. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.024337,
     "end_time": "2021-02-21T17:17:54.368605",
     "exception": false,
     "start_time": "2021-02-21T17:17:54.344268",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Next, we summarize the results."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:54.423027Z",
     "iopub.status.busy": "2021-02-21T17:17:54.422073Z",
     "iopub.status.idle": "2021-02-21T17:17:54.458426Z",
     "shell.execute_reply": "2021-02-21T17:17:54.456968Z"
    },
    "papermill": {
     "duration": 0.064967,
     "end_time": "2021-02-21T17:17:54.458569",
     "exception": false,
     "start_time": "2021-02-21T17:17:54.393602",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A xtable: 3 × 2</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Estimate</th><th scope=col>Std. Error</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>Without controls</th><td>-0.07503201</td><td>0.01834260</td></tr>\n",
       "\t<tr><th scope=row>full reg</th><td>-0.06763390</td><td>0.01676536</td></tr>\n",
       "\t<tr><th scope=row>partial reg</th><td>-0.06763390</td><td>0.01676536</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A xtable: 3 × 2\n",
       "\\begin{tabular}{r|ll}\n",
       "  & Estimate & Std. Error\\\\\n",
       "  & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\tWithout controls & -0.07503201 & 0.01834260\\\\\n",
       "\tfull reg & -0.06763390 & 0.01676536\\\\\n",
       "\tpartial reg & -0.06763390 & 0.01676536\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A xtable: 3 × 2\n",
       "\n",
       "| <!--/--> | Estimate &lt;dbl&gt; | Std. Error &lt;dbl&gt; |\n",
       "|---|---|---|\n",
       "| Without controls | -0.07503201 | 0.01834260 |\n",
       "| full reg | -0.06763390 | 0.01676536 |\n",
       "| partial reg | -0.06763390 | 0.01676536 |\n",
       "\n"
      ],
      "text/plain": [
       "                 Estimate    Std. Error\n",
       "Without controls -0.07503201 0.01834260\n",
       "full reg         -0.06763390 0.01676536\n",
       "partial reg      -0.06763390 0.01676536"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "table<- matrix(0, 3, 2)\n",
    "table[1,1]<- nocontrol.est  \n",
    "table[1,2]<- nocontrol.se   \n",
    "table[2,1]<- control.est\n",
    "table[2,2]<- control.se    \n",
    "table[3,1]<- partial.est  \n",
    "table[3,2]<- partial.se  \n",
    "\n",
    "colnames(table)<- c(\"Estimate\",\"Std. Error\")\n",
    "rownames(table)<- c(\"Without controls\", \"full reg\", \"partial reg\")\t\n",
    "tab<- xtable(table, digits=c(3, 3, 4))\n",
    "tab"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:54.513692Z",
     "iopub.status.busy": "2021-02-21T17:17:54.511988Z",
     "iopub.status.idle": "2021-02-21T17:17:54.528106Z",
     "shell.execute_reply": "2021-02-21T17:17:54.526677Z"
    },
    "papermill": {
     "duration": 0.044599,
     "end_time": "2021-02-21T17:17:54.528256",
     "exception": false,
     "start_time": "2021-02-21T17:17:54.483657",
     "status": "completed"
    },
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<!-- html table generated in R 4.3.3 by xtable 1.8-4 package -->\n",
      "<!-- Sat Apr 13 20:58:46 2024 -->\n",
      "<table border=1>\n",
      "<tr> <th>  </th> <th> Estimate </th> <th> Std. Error </th>  </tr>\n",
      "  <tr> <td align=\"right\"> Without controls </td> <td align=\"right\"> -0.075 </td> <td align=\"right\"> 0.0183 </td> </tr>\n",
      "  <tr> <td align=\"right\"> full reg </td> <td align=\"right\"> -0.068 </td> <td align=\"right\"> 0.0168 </td> </tr>\n",
      "  <tr> <td align=\"right\"> partial reg </td> <td align=\"right\"> -0.068 </td> <td align=\"right\"> 0.0168 </td> </tr>\n",
      "   </table>\n"
     ]
    }
   ],
   "source": [
    "print(tab, type=\"html\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.025712,
     "end_time": "2021-02-21T17:17:54.579623",
     "exception": false,
     "start_time": "2021-02-21T17:17:54.553911",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<!-- html table generated in R 4.3.3 by xtable 1.8-4 package -->\n",
    "<!-- Sat Apr 13 20:58:46 2024 -->\n",
    "<table border=1>\n",
    "<tr> <th>  </th> <th> Estimate </th> <th> Std. Error </th>  </tr>\n",
    "  <tr> <td align=\"right\"> Without controls </td> <td align=\"right\"> -0.075 </td> <td align=\"right\"> 0.0183 </td> </tr>\n",
    "  <tr> <td align=\"right\"> full reg </td> <td align=\"right\"> -0.068 </td> <td align=\"right\"> 0.0168 </td> </tr>\n",
    "  <tr> <td align=\"right\"> partial reg </td> <td align=\"right\"> -0.068 </td> <td align=\"right\"> 0.0168 </td> </tr>\n",
    "   </table>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n",
      "Attaching package: 'gridExtra'\n",
      "\n",
      "\n",
      "The following object is masked from 'package:dplyr':\n",
      "\n",
      "    combine\n",
      "\n",
      "\n",
      "Warning message:\n",
      "\"In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :\n",
      " extra argument 'data1' will be disregarded\"\n",
      "Warning message:\n",
      "\"In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :\n",
      " extra argument 'data1' will be disregarded\"\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAPFBMVEUAAAAAAP8zMzNNTU1oaGh8fHyMjIyampqnp6eysrK9vb2+vr7Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD///926Sy8AAAACXBIWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO2di3aquhpG4wmKur0teP93PdxUtNCifEqSf84xdmvV1UnSzi1GKq4EgNm4pTcAIAUICUAAIQEIICQAAYQEIICQAAQQEoAAQgIQQEgAAggJQIAgJOcOt0vj9zpsnHOb46/fqcjHHe9sGcC3kITkb5fG7nP2rmX9+3d6/RaAEJCE5PLrpZG7nKsHo1P1+bR2m1+/0+u3AISAJKSNO3eXRu6SuX13ae1+2bsjJIgVSUiFy7pLzadz7p3Pz/d7HO+PQ2e3fbpL9Y+23mXH5qGt/g7V98uaf/B4p/rrai8yP83fYgA1kpDKffuI04Z07J4O3R96Ns8PQ/27VM+busu3kDauzu3xTtV+4Y/vCxAKmpDKzBfl9XHDuV1RFlvnLtd7eFc8/IuHu1SPMqey2NTLEG2IVVnFzzvV+4f16uChe/QDCAlRSOdmvaEJYdvuvJV597n8+Qzn4S7tQ0zRPha19z4N3InnSRAyopCqX/dzdynrHoku94eO5wQe7tLd2A9p+E6b6gnS4VICBIgqpMJfm7hVc88ne9q1e7jLWEg/7nRpXovK9iVAcKhCatYbxkLK+wsEl3dDKstjXqe0m7/JAGJkIdXrDWO7dr3l74tfv7tr13DOb8dRAISDLqSzy7vFhvY4h95iQ+mvh+NVu2fHp7uMhTR0p97NACGhC6nMm1eBqkcQt22Xre8vyZ7aQ4SKvW8emx7u8hDS5f79ftypXf7e/nqQEcAyCEMq/NgLsvfrugqeX2str6n0l7lHXpD1LNxBeAhDKg9jhwhVFLv6+IX8Gtfz0T/dq1FZ/QSo93zo8U6n5hAhOoIA4QkHgABCAhBASAACCAlAACEBCCAkAAGEBCCAkAAEEBKAAEICEEBIAAIICUAAIQEImB3Sv7+Zch81OHF+QUpIOHEKpISEE6dASkg4cQqkhIQT51/8999/f92FkHDi/AtCwolTACHhxCmAkHDiFEBIOHEKICScOAUQEk6cAggJJ04BhIQTpwBCwolTACHhxCmAkHDi/I6UkHDiFEgJCSdOgZSQcOIUSAkJJ06BlJBw4hRICQknToGUkHDiFEgJCSdOgZSQcOIUSAkJJ06BlJBw4hRICQknzr/goFWcOAUQEk6cAggJJ04BhIQTpwBCwolTACHhxCmAkHDiFEBIOHEKICScOAUQEk6cAggJJ04BhIQT53ekhIQTp0BKSDhxCqSEhBOnQEpIOHEKpISEE6dASkg4cQqkhIQTp0BKSDhxCqSEhBOnQEpIOHEKpKMhue5r7wkJp3Hn2yF514OQcBp3vn3Q6r7X0Z6QcBp3zjn6e/ojESHhTNzJn1HgxClgVkhbz3MknDhr5oS0ZbEBJ86WOSH56asMhIQzbSeLDThxCpgT0sYVhIQTZ82ckC5+fSEknDj/zd21Y7EBJ84GQsKJUwAvyOLE+R0pIeHEKZD+EtJ+U+3Wrc+EhNO6c05IRdY8P3LuREg4jTvnhJS7bf2i7MGtCQmncefcv5C9/kdIOE07CQknzu9IR0Pqdu22LicknMadsxYbuj9H8pMPFJJsjx6cOL8gHQ2pLHeZc9l2+qGrku3RgxPnF6S/hPQqku3RgxPnF6SEhBOnQDocUvNKLAet4sTZ8PZBq4SEE+cdjv7GiVMAIeHEKWBWSJvmCpfxOhJO686Z72vXXMuRDTjNO+e9r13z9xNnFhtwmncq3teOkHCad857X7u8KMtiy98j4TTvnPe+dt1Bq5P/1nzCBlmZeJxpOWet2hXb5qDV6e8SOWGDrEz8952riq9LjcwtryPZca5Wi5RkYm7/EZIZ52q1TEkW5naidDgkjrWLyrlaLVSSgbmdKiWk+J2r1VIlpT+3k6XDIWUj9fiK+2ffXkdIrzpX0TBvnB8hqpCaR6SBjroP/c/N5f/VTH3kiomlf5HTZOmf6meZGlJ5D6n6z99vlYStJ0Dn0r/I05k3zo8Q1SPS2rnB50i+25vzt3283o2S7dFjwDn5F1+NgbmdKh0O6XpYw8/FBn/bnXt4jCKkRZ0LdWRibidKh0PKhnftru34+2V27YJwLtORjbmdJh0O6dXFBkJa2rlIR0bmdpL0pZBY/sZp0ilfbPgVyfbowYnzC9LhkMYXGwgJpz2n4i9kpzNhg6xMPM60nBz9jROngHkhcTJmnDgb5oTEyZhx4uyYExInY8aJs2PuYgPnkMWJ8x8h4cQpQbBrx8mYceKctdjAyZhx4myZt/zNyZhx4mzgBVmcOAUQEk6c35GOh9S9ZTG7djjNO+eEdGGxASfOydLRkHK3rhK6rFn+xmneOSckTjSGE+d0KSHhxCmQjobErh1OnNOloyGx2IAT53TpaEgsf+PEOV06HtLLSLZHD06cX5ASEk6cAulYSPvmfR9P+fS3bCAknKk63w9p7VyTkHdbQsJp3fn2QasH54/NhZN3B0LCadz5dkhrd+wuHXnzE5zmnW+H1DucgSMbcJp3SkLqn0uMkHBadM7Ytbsez3DhECGc5p1vh7S/5ZPfni0REk6rzvf/1Ny7Tf1WxaeNy6Z2REg4U3W+H9LtBEnTj1klJJypOue8+clhU2W0mfwiEiHhTNfJuwjhxCmAkHDiFEBIOHF+R0pIOHEKpISEE6dASkg4cQqkhIQTp0BKSDhxCqSEhBOnQEpIOHEKpISEE6dASkg4cQqkhIQTp0BKSDhxCqSEhBPnX3DQKk6cAggJJ04BhIQTpwBCwolTACHhxCmAkHDiFEBIOHEKICScOAUQEk6cAggJJ04BhIQTpwBCwonzO1JCwolTICUknDgFUkLCiVMgJSScOAVSQsKJUyAlJJw4BVJCwolTICUknDgFUkLCiVMgJSScOAVSQsKJUyAlJJw4/4KDVnHiFEBIOHEKICScOAUQEk6cAggJJ04BhIQTpwBCwolTACHhxCmAkHDiFEBIOHEKICScOAV8N6QJ/O8LjhBgnInxykAJSQfjTAxCWgbGmRiEtAyMMzFCCwkgeQgJQAAhAQggJAABhAQggJAABBASgABCAhDwuZB8Re+r23V+5P6xMjbOhTbnY/THdL2c4M9zbJh//buPheRvH9pNKR++ToehcT5elwb9Md0uJzbGcniYk36c3wnJlzZC8iUhxU3gIaX5u9UwOs7EBjv6G5YWkYSU3i617ZDS+3lGEtKULYoMi+N86TcsLuII6elSElgOqex/ToOQQmof79MPaXycaYX0c5yE9BN27WZicZzs2v3k6yGlNe+EZGSYy4V0f1m47H1MbpXH5jhfeck/Mt4dJsfaAQggJAABhAQggJAABBASgABCAhBASAACCAlAACHFQeGy7lLmLverHT+/QOAHEQnrrp+LW/euJaRQ4AcRCQe3az7v3KF3LSGFAj+ISLju22WuKMvTxjm/LduQ2piaj0XuXF4suJV2IaRY2DT7ds2e3dE1bH+E5Ours9+/D3wEQoqFY7Nv1+zZZfWH8zWie0i7uq2t2y+8pSYhpGhoHmqaPbvqgem4W/8MKWsvbRbcSLMQUjTk1b7dpa1k3e7bPYfk3PV6+DZMejTU+3Y7dyzrpLL98UJIIcGkx0O1b5f1VugeQrrcd+1gCZj6eMjd0eX1BedOZXF7juTdoftqWy82HB5esYUvQUjxUK9613t2VTD950jNV7v6UtEsf7vz0htqEUKKCH99+pM7tz7dduu2vnr21O7gNTcsuYlmISQAAYQEIICQAAQQEoAAQgIQQEgAAggJQAAhAQggJAABhAQggJAABBASgABCAhBASAACCAlAACEBCCAkAAGEBCCAkAAEEBKAAEICEEBIAAIICUCAJqTDxjm3Of56nyIf3QZqhthR/A6ffffOn7++V+54LoQE0SP4HT5XD0b1u3ue1r+emYeQIGEEv8PZ7RRxa/fL3h0hQcLM/x0+3h+HzvXZEKpPuXc+b97KvWpk61127M7dU38qsuYfPN6p/tpVX/O+1RAn80PaPD8MdacKbq6unjd1l28hbZqzCD/eqdov7H0NEB3zQ/Lu8Xz01VOmXVEWW1efhbt6lDmVxaZehrieWG5d/LxTd37h8sApuSFO5of0/Axn2+7flXl7+vr6IeZ2crn2HFk/78TzJIgcfUhZ/SBT1idjzG43Pp7qdOhOm+oJ0uEye2MAlmF+SNnTrt0trN4DzY+Qftzp0rwWle1LgBiZH1LeXyC4vBtSWR7z5hSOs7cHYAGky98Xv353167hnDs/e3sAFkDwHN83C25ls3t2rNcR2oPqbusI5UBIQ3fq3QwQGYJf3FN7iFCx981j08W5bbuyfX4K6VLervhxp3b5e/vrQUYAwaJ4BLi+uNpV8Pxaa3lNpb/MPfKCrGfhDqJEsitV7OrjF/LrosPz0T/tp3NWPwHqPR96vNOpOUSIjiBOeE4CIICQAAQQEoAAQgIQQEgAAggJQAAhAQggJAABhAQggJAABBASgABCAhBASAACZof072+m3EcNTpxfkBISTpwCKSHhxCmQEhJOnAIpIeHE+Rf//fffX3chJJw4/4KQcOIUQEg4cQogJJw4BRASTpwCCAknTgGEhBOnAELCiVMAIeHEKYCQcOIUQEg4cQogJJw4vyMlJJw4BVJCwolTICUknDgFUkLCiVMgJSScOAVSQsKJUyAlJJw4BVJCwolTICUknDgFUkLCiVMgJSScOAVSQsKJ8y84aBUnTgGEhBOnAELCiVMAIeHEKYCQcOIUQEg4cQogJJw4BRASTpwCCAknTgGEhBOnAELCiVMAIeHE+R0pIeHEKZASEk6cAikh4cQpkBISTpwCKSHhxCmQEhJOnAIpIeHEKZASEk6cAikh4cQpkBISTpwC6WhIrvvae0LCadz5dkje9SAknMadbx+0uu91tCcknMadc47+nv5IREg4E3fyZxQ4cQqYFdLW8xwJJ86aOSFtWWzAibNlTkh++ioDIeFM28liA06cAuaEtHEFIeHEWTMnpItfXwgJJ85/c3ftWGzAibOBkHDiFMALsjhxfkdKSDhxCqS/hLTfVLt16zMh4bTunBNSkTXPj5w7ERJO4845IeVuW78oe3BrQsJp3Dn3L2Sv/xESTtNOQsKJ8zvS0ZC6XbutywkJp3HnrMWG7s+R/OQDhSTbowcnzi9IR0Mqy13mXLadfuiqZHv04MT5BekvIb2KZHv04MT5BSkh4cQpkA6H1LwSy0GrOHE2vH3QKiHhxHmHo79x4hRASDhxCpgV0qa5wmW8joTTunPm+9o113JkA07zznnva9f8/cSZxQac5p2K97UjJJzmnfPe1y4vyrLY8vdIOM07572vXXfQ6uS/NZ+wQVYmHmdazlmrdsW2OWh1+rtETtggKxMfonNV8W3nJ4gupJeZsEFWJj5A52r1gZICHOdHICScHavVJ0oKb5yLSYdD4li7xJyr1UdKCm6cy0kJyYJztfpMSaGNc0HpcEjZSD2+4v7Zt9cR0mecq+CJd2710l8ekQY66j70PzeX/1cz9ZErUZb+rU6CpX+ICqaGVN5Dqv7z91slYeuJ1rn0L/XfxDu3eulwSGvnBp8j+W5vzt/28Xo3SrZHD85/LDZ8Xjoc0vWwhp+LDf62O/fwGEVIgTs/0lGA41xMOhxSNrxrd23H3y+zaxeJ8xMdhTjOpaTDIb262EBI4Ts/0FGQ41xI+lJILH/jNOmULzb8imR79ODE+QXpcEjjiw2EhNOeU/EXstOZsEFWJh5nWk6O/saJU8C8kDgZM06cDXNC4mTMOHF2zAmJkzHjxNkxd7GBc8jixPmPkHDilCDYteNkzDhxzlps4GTMOHG2zFv+5mTMOHE28IIsTpwCCAknzu9Ix0Pq3rKYXTuc5p1zQrqw2IAT52TpaEi5W1cJXdYsf+M075wTEicaw4lzupSQcOIUSEdDYtcOJ87p0tGQWGzAiXO6dDQklr9x4pwuHQ/pZSTbowcnzi9ICQknToF0LKR9876Pp3z6WzYQEs5Une+HtHauSci7LSHhtO58+6DVg/PH5sLJuwMh4TTufDuktTt2l468+QlO8863Q+odzsCRDTjNOyUh9c8lRkg4LTpn7Npdj2e4cIgQTvPOt0Pa3/LJb8+WCAmnVef7f2ru3aZ+q+LTxmVTOyIknKk63w/pdoKk6cesEhLOVJ1z3vzksKky2kx+EYmQcKbr5F2EcOIUQEg4cQogJJw4vyMlJJw4BVJCwolTICUknDgFUkLCiVMgJSScOAVSQsKJUyAlJJw4BVJCwolTICUknDgFUkLCiVMgJSScOAVSQsKJ8y84aBUnTgGEhBOnAELCiVMAIeHEKYCQcOIUQEg4cQogJJw4BRASTpwCCAknTgGEhBOnAELCiVMAIeHE+R0pIeHEKZASEk6cAikh4cQpkBISTpwCKSHhxCmQEhJOnAIpIeHEKZASEk6cAikh4cQpkBISTpwCKSHhxCmQEhJOnH/BQas4cQogJJw4BRASTpwCCAknTgGEhBOnAELCiVMAIeHEKYCQcOIUQEg4cQogJJw4BRASTpwCvhvSBP73BUcIMM7EeGWghKSDcSYGIS0D40wMQloGxpkYoYUEkDyEBCCAkAAEEBKAAEICEEBIAAIICUAAIQEI+FxIvqL31e06P3L/WBkb50Kb8zH6Y7peTvDnOTbMv/7dx0Lytw/tppQPX6fD0Dgfr0uD/phulxMbYzk8zEk/zu+E5EsbIfmSkOIm8JDS/N1qGB1nYoMd/Q1Li0hCSm+X2nZI6f08IwlpyhZFhsVxvvQbFhdxhPR0KQksh1T2P6dBSCG1j/fphzQ+zrRC+jlOQvoJu3YzsThOdu1+8vWQ0pp3QjIyzOVCur8sXPY+JrfKY3Ocr7zkHxnvDpNj7QAEEBKAAEICEEBIAAIICUAAIQEIICQAAYQEIICQ4qBwWXcpc5f71Y6fXyDwg4iEddfPxa171xJSKPCDiISD2zWfd+7Qu5aQQoEfRCRc9+0yV5TlaeOc35ZtSG1Mzccidy4vFtxKuxBSLGyafbtmz+7oGrY/QvL11dnv3wc+AiHFwrHZt2v27LL6w/ka0T2kXd3W1u0X3lKTEFI0NA81zZ5d9cB03K1/hpS1lzYLbqRZCCka8mrf7tJWsm737Z5Dcu56PXwbJj0a6n27nTuWdVLZ/nghpJBg0uOh2rfLeit0DyFd7rt2sARMfTzk7ujy+oJzp7K4PUfy7tB9ta0XGw4Pr9jClyCkeKhXves9uyqY/nOk5qtdfalolr/deekNtQghRYS/Pv3JnVufbrt1W189e2p38JobltxEsxASgABCAhBASAACCAlAACEBCCAkAAGEBCCAkAAEEBKAAEICEEBIAAIICUAAIQEIICQAAYQEIICQAAQQEoAAQgIQQEgAAggJQAAhAQggJAABhAQgYGZI13ebXo+dSqTo3hr0x7/rv2/1O7TfGCAMRCG5sffJ7Z0F6/nqeSHxVvEQErNDaj+f/MjprUZ+3+dF9Ms3BlgEUUjlaeQhiZDABKqQukvb7Prm084Vmdv03uv96dZeTNWHrXdZ8/7w5XHt/P4hk3Punc/PPV31ifMAQVBoQ2rPhtCcMsHVFW0fQnq49SGk9e2GXXua4V4k3ZmHb/+sJCQID1VIx3rXbtedL3jd3LIubndoPj7e+hCSP5XFpr7h7OrzDB/9PZLqml1RFlVal35I7NpBUIhCqn71j7czBXd1nO53aD4+3voQUv1oU7Tn+mnWLA73TJqTZ5X1mUy2hATBIlv+bn/dy3N3uu3+7/z9t/7h1v5zpOudutiKeyZZ/UhU1ud2zAgJgkUTkt+0KwV7fzsb8EBIT7cOhXTN43kR4/FmQoLQkC021OyrJ0bbw2UkpOdbCQnSQRpS1nte9DOk51vZtYN0kIbUfnUcCen51qGQusWGfX+xoT2orltsKK7fgpAgJMSPSPvb2vWtjkt5e0R6vHUopHb5+9B7jajaFdy2y9/nsly7TdF9C9c9UgGEgPo5Usvpdkt2f0H2+dahkLoXZPsvtvZfkD3dX67NeEEWAkIaUr0u5/PT0W1ut5wz53urdv1bB0OqDxFym1P/+/YOESpP1bfbtY9dzTcGCIMw/69e1LEBxENgITVPkcrTeuSPMgACJbCQrk+RRv5MECBQAgupPNZ/ebE+LL0ZAK8RWkgAUUJIAAIICUAAIQEIICQAAYQEIICQAAQQEoAAQgIQMCukf38z5T5yzEjNDDTU2SWkNKRmBhrq7BJSGlIzAw11dgkpDamZgYY6u4SUhtTMQJeQ/vfff3/eh5DSkJoZKCFZmXVCSk5KSHakZgZKSFZmnZCSkxKSHamZgRKSlVknpOSkhGRHamaghGRl1gkpOSkh2ZGaGSghWZl1QkpOSkh2pGYGSkhWZp2Q0pNy0KoZqZmBhjq7hJSG1MxAQ51dQkpDamagoc4uIaUhNTPQUGeXkNKQmhloqLNLSGlIzQw01NklpDSkZgYa6uwSUhpSMwMNdXYJKQ2pmYGGOruElIbUzEBDnV1CSkNqZqChzi4hpSE1M1AOWrUy64SUnJSQ7EjNDJSQrMw6ISUnJSQ7UjMDJSQrs05IyUkJyY7UzEAJycqsE1JyUkKyIzUzUEKyMuuElJyUkOxIzQyUkKzMOiElJyUkO1IzAw11dgkpDamZgYY6u4SUhtTMQEOdXUJKQ2pmoKHOLiGlITUz0FBnl5DSkJoZaKizS0hpSM0MNNTZJaQ0pGYGGursElIaUjMDDXV2CSkNqZmBhjq7hJSG1MxAQ53d0ZBc97X3hBSB1MxAQ53d4ZC860FIEUjNDDSug1b3vY72hBSB1MxA4wqpvO/aTWPC1liZdUJKTsqfUdiRmhlofCFtPc+R4pGaGWh0IW1ZbIhJamag0YXkp60yEFIYUjMDjS4kFhuikpoZaHQhbVxBSPFIzQw0upAufn0hpGikZgYaXUgc2RCV1MxACcnKrBNSclJekLUjNTPQUGeXkNKQmhloqLP7S0j7TbVbtz4TUgxSMwMNdXZHQyqy5vmRcydCikBqZqChzu5oSLnb1i/KHtyakCKQmhloqLM7GlK9Wnf9j5CCl5oZaKizS0hpSM0MNNTZHQ2p27XbupyQIpCaGWioszsaUtH9OZKfdKCQZmP0mJGaGWioszsaUlnuMuey7bRDVzUbo8eM1MxAQ53dX0J6Bc3G6DEjNTPQUGeXkNKQmhloqLM7HFLzSiwHrUYkNTPQuA5aJaTYpGYGGldILzNha6zMOiElJyUkO1IzA40vpE1zhct4HSkGqZmBRhfStn1y5DiyIQqpmYFGF5Jv/37izGJDFFIzA40upGtAhBSF1MxAowtp4/KiLIstf48UhdTMQKML6XI9aHXS35pP2Bors05IyUnnrdoV2+ag1WnvEjlha6zMeqAhrSq+Lv0E0YX0EhO2xsqshxnSavWBkqzM7sdC8i2EFI70D+dq9YmSmN3eXQZDGjnWzj9+7pWk2Rg9ZqS/O1erj5TE7PbuMiOkXkmajdFjRvqrc7X6TEnMbu8ugyFlg/t5t905QvqKdBU0woG+RFQhNY9IAyUNfv5fxVB39lj6dztmlv7Z6Xg7pBpN1Xqili79u/07woG+RFSPSGvneI4UlZTFhoWdwyFdD2sgpFikLH8v7BwOKWPXLjIpL8gu7BwOadpzJF5HCkfKIUILO18LqV7+9hzZEKDUzEBDnd3hkEYWG8bRbIweM1IzAw11dodDGllsIKRgpWYGGt1Bq9MCIqRApGYGGl1IrzFha6zMOiElJ50ZEidjjkhqZqDRhcTJmKOSmhlodCFxMuaopGYGGl1InEM2KqmZgRKSlVknpOSkil07TsYch9TMQKMLiZMxRyU1M9DoQuJkzFFJzQw0wpBeYcLWWJl1QkpOSkh2pGYGGursjofUvWUxu3ZRSM0MNNTZHQ3pwmJDTFIzAw11dkdDyt26SuiyZvk7CqmZgYY6u6MhcaKxqKRmBhrq7BJSGlIzAw11dkdDYtcuKqmZgYY6u6MhsdgQldTMQEOd3dGQWP6OSmpmoKHO7nhIL6HZGD1mpGYGGursElIaUjMDDXV2x0LaN2//eMqnvWUDIS0tNTPQUGd3JKS1c01C3m0JKQapmYHGddDqwfljc+Hk3YGQIpCaGWhcIa3dsbt05M1PopCaGWhcIfUOZ+DIhiikZgYab0j9k04QUqhSMwONK6S1ux7PcOEQoSikZgYaV0j7Wz757dkSIYUsNTPQuEIqvdvUb1V82rhsSkeEtLTUzEAjC+l2gqRpx6wS0tJSMwONLKSyPGyqjDaTXkQipOWlZgYaXUivMWFrrMw6ISUnJSQ7UjMDJSQrs05I6Un5MwozUjMDDXV2CSkNqZmBhjq7hJSG1MxAQ51dQkpDamagoc4uIaUhNTPQUGeXkNKQmhloqLNLSGlIzQw01NklpDSkZgYa6uwSUhpSMwMNdXYJKQ2pmYGGOruElIbUzEBDnV1CSkNqZqActGpl1gkpOSkh2ZGaGSghWZl1QkpOSkh2pGYGSkhWZp2QkpMSkh2pmYESkpVZJ6TkpIRkR2pmoIRkZdYJKTkpIdmRmhkoIVmZdUJKTkpIdqRmBhrq7BJSGlIzAw11dgkpDamZgYY6u4SUhtTMQEOdXUJKQ2pmoKHOLiGlITUz0FBnl5DSkJoZaKizS0hpSM0MNNTZJaQ0pGYGGursElIaUjMDDXV2CSkNqZmBhjq7hJSG1MxAQ51dQkpDamagHLRqZdYJKTkpIdmRmhkoIVmZdUJKTkpIdqRmBkpIVmadkJKTEpIdqZmBEpKVWSek5KSEZEdqZqCEZGXWCSk5KSHZkZoZKCFZmXVCSk76xZAm8L8Pf/9wMDNSBjoEIakwM1IGOgQhqTAzUgY6BCGpMDNSBjrEp0MCMAEhAQggJAABhAQggJAABBASgABCAhBASAACPhOSr+h9dbvOj9w/XsZGutDmfI7+oK6XE/yRjg3zz3/4kQz0Oe8AAAINSURBVJD87UO7HeXD1ykxNNLH6xKhP6jb5dQGOTzMaT/Pz4fkSysh+ZKQIifkkBL9zWoZHWlqwx39DUuLGEJKb3+6tB5Sej/SGEKatDmxYWak7/+GRUUEIT1dSgTTIZX9z2kQTEjtg72FkMZHmlhIPwdKSAOwazcLMyNl1+4PvhpSWpNeYz6kxMYZWEj314TL3sfklnhqzIy0P9CXXvKPi7eHybF2AAIICUAAIQEIICQAAYQEIICQAAQQEoAAQgIQQEgxULisu5S5y/1qx08vGPhRRMG66+fi1r1rCSkc+FFEwcHtms87d+hdS0jhwI8iCq77dpkryvK0cc5vyzakNqbmY5E7lxcLbqVlCCkONs2+XbNnd3QN2x8h+frq7PfvAx+CkOLg2OzbNXt2Wf3hfI3oHtKubmvr9gtvqVEIKRKah5pmz656YDru1j9DytpLmwU30jCEFAl5tW93aStZt/t2zyE5d70evg/THgn1vt3OHcs6qWx/vBBSWDDtsVDt22W9FbqHkC73XTtYBiY/FnJ3dHl9wblTWdyeI3l36L7a1osNh4dXbOFrEFIs1Kve9Z5dFUz/OVLz1a6+VDTL3+689IbahJCiwV+f/uTOrU+33bqtr549tTt4zQ1LbqJhCAlAACEBCCAkAAGEBCCAkAAEEBKAAEICEEBIAAIICUAAIQEIICQAAYQEIOD/4a/pKlr1qcAAAAAASUVORK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "##################################################COEF PLOT\n",
    "library(coefplot)\n",
    "library(gridExtra)\n",
    "flex.y <- lwage ~  (exp1+exp2+exp3+exp4)*(scl+clg+ad+occ2+ind2+mw+so+we) # model for Y\n",
    "flex.d <- sex ~ (exp1+exp2+exp3+exp4)*(scl+clg+ad+occ2+ind2+mw+so+we) # model for D\n",
    "# partialling-out the linear effect of W from Y\n",
    "t.Y <- lm(flex.y, data1=data1)$res\n",
    "# partialling-out the linear effect of W from D\n",
    "t.D <- lm(flex.d, data1=data1)$res\n",
    "\n",
    "# Ajustar los modelos\n",
    "nocontrol.fit <- lm(lwage ~ sex)\n",
    "control.fit <- lm(lwage ~ sex + (exp1+exp2+exp3+exp4)*(scl+clg+ad+occ2+ind2+mw+so+we))\n",
    "partial.fit <- lm(t.Y ~ t.D)\n",
    "\n",
    "\n",
    "\n",
    "# Graficar los coeficientes estimados con límites en el eje x ajustados\n",
    "plot_nocontrol <- coefplot(nocontrol.fit, coefficients = \"sex\")+labs(title = \"No Controls\") + xlim(-0.15, 0)\n",
    "plot_control <- coefplot(control.fit, coefficients = \"sex\")+labs(title = \"Controls\")  + xlim(-0.15, 0)\n",
    "plot_partial <- coefplot(partial.fit, coefficients = \"t.D\")+labs(title = \"Partialling out\")  + xlim(-0.15, 0)\n",
    "\n",
    "# Unir los gráficos verticalmente\n",
    "combined_plot <- grid.arrange(plot_nocontrol, plot_control, plot_partial, nrow = 3)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The coefficient associated with the gender variable, which indicates the prediction of being female on salary, is initially negative. This suggests that, on average, women have lower salaries than men. However, after adding these controls, such as work experience or educational level, the negative coefficient associated with the gender variable becomes  less negative.\n",
    "\n",
    "This change in the gender coefficient could be explained by the fact that the control variables are capturing some of the variability in salaries that was previously incorrectly attributed to gender. This suggests that additional factors, beyond gender, are influencing salaries, and the impact of gender on salaries is less pronounced once these other variables are taken into account. Besides, both FWL and including control  variables in the regression model yield coefficient estimates for the variable of interest that reflect its net impact on the dependent variable, once the effects of other explanatory variables have been taken into account."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"pseudoinverse used at -0.10036 -0.010002\"\n",
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"neighborhood radius 4.8847\"\n",
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"reciprocal condition number  2.6408e-15\"\n",
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"There are other near singularities as well. 410.95\"\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "Plot with title \"Mean lwage vs exp4 with Loess Smoothing and Mean lwage vs exp4 (Women only)\""
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Generar valores de exp4 para predecir las medias de lwage con más puntos\n",
    "exp4_seq <- seq(min(data$exp4), max(data$exp4), length.out = 500)\n",
    "\n",
    "# Ajustar el modelo LOESS \n",
    "loess_model <- loess(lwage ~ (exp4 + sex), data = data, span = 0.9)\n",
    "\n",
    "# Crear un nuevo data frame con los valores de exp4 para predecir\n",
    "new_data <- data.frame(exp4 = exp4_seq, sex = 1)\n",
    "\n",
    "# Predecir las medias de lwage utilizando el modelo loess\n",
    "lwage_mean_pred <- predict(loess_model, newdata = new_data)\n",
    "\n",
    "# Calcula la media de lwage para cada valor único de exp4 solo para mujeres\n",
    "mean_lwage_women <- tapply(subset(data, sex == 1)$lwage, subset(data, sex == 1)$exp4, mean)\n",
    "\n",
    "# Graficar ambas relaciones en un solo gráfico\n",
    "plot(exp4_seq, lwage_mean_pred,\n",
    "     type = \"l\",  # Tipo de gráfico: línea\n",
    "     col = \"red\", # Color de la línea para el modelo LOESS\n",
    "     lwd = 2,     # Grosor de la línea para el modelo LOESS\n",
    "     xlab = \"exp4\",\n",
    "     ylab = \"Mean lwage\",\n",
    "     main = \"Mean lwage vs exp4 with Loess Smoothing and Mean lwage vs exp4 (Women only)\",\n",
    "     xlim = c(0, 40),  # Limitar los valores en el eje x de 0 a 40\n",
    "     ylim = c(2.6, 3.4))   # Ajustar la escala del eje y de 2 a 4\n",
    "lines(as.numeric(names(mean_lwage_women)), mean_lwage_women, col = \"blue\", lwd = 2)  # Agregar la relación de media de lwage vs exp4\n",
    "legend(\"topright\", legend = c(\"Loess Smoothing\", \"Mean lwage (Women only)\"), col = c(\"red\", \"blue\"), lty = 1, lwd = 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"pseudoinverse used at -0.10036 -0.010002\"\n",
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"neighborhood radius 4.8847\"\n",
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"reciprocal condition number  2.6408e-15\"\n",
      "Warning message in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, :\n",
      "\"There are other near singularities as well. 410.95\"\n"
     ]
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "Plot with title \"Mean lwage vs exp4 with Loess Smoothing and Mean lwage vs exp4 (Men only)\""
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Generar valores de exp4 para predecir las medias de lwage con más puntos\n",
    "exp4_seq <- seq(min(data$exp4), max(data$exp4), length.out = 500)\n",
    "\n",
    "# Ajustar el modelo LOESS \n",
    "loess_model_men <- loess(lwage ~ (exp4 + sex), data = data, span = 0.9)\n",
    "\n",
    "# Crear un nuevo data frame con los valores de exp4 para predecir\n",
    "new_data_men <- data.frame(exp4 = exp4_seq, sex = 0)  # Solo varones\n",
    "\n",
    "# Predecir las medias de lwage utilizando el modelo loess para varones\n",
    "lwage_mean_pred_men <- predict(loess_model_men, newdata = new_data_men)\n",
    "\n",
    "# Calcula la media de lwage para cada valor único de exp4 solo para varones\n",
    "mean_lwage_men <- tapply(subset(data, sex == 0)$lwage, subset(data, sex == 0)$exp4, mean)\n",
    "\n",
    "# Graficar ambas relaciones en un solo gráfico\n",
    "plot(exp4_seq, lwage_mean_pred_men,\n",
    "     type = \"l\",  # Tipo de gráfico: línea\n",
    "     col = \"red\", # Color de la línea para el modelo LOESS\n",
    "     lwd = 2,     # Grosor de la línea para el modelo LOESS\n",
    "     xlab = \"exp4\",\n",
    "     ylab = \"Mean lwage\",\n",
    "     main = \"Mean lwage vs exp4 with Loess Smoothing and Mean lwage vs exp4 (Men only)\",\n",
    "     xlim = c(0, 40),  # Limitar los valores en el eje x de 0 a 40\n",
    "     ylim = c(2.6, 3.4))   # Ajustar la escala del eje y de 2 a 4\n",
    "lines(as.numeric(names(mean_lwage_men)), mean_lwage_men, col = \"blue\", lwd = 2)  # Agregar la relación de media de lwage vs exp4 para varones\n",
    "legend(\"topright\", legend = c(\"Loess Smoothing\", \"Mean lwage (Men only)\"), col = c(\"red\", \"blue\"), lty = 1, lwd = 2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.025752,
     "end_time": "2021-02-21T17:17:54.682415",
     "exception": false,
     "start_time": "2021-02-21T17:17:54.656663",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Next we try \"extra\" flexible model, where we take interactions of all controls, giving us about 1000 controls."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2021-02-21T17:17:54.739845Z",
     "iopub.status.busy": "2021-02-21T17:17:54.738234Z",
     "iopub.status.idle": "2021-02-21T17:18:01.410371Z",
     "shell.execute_reply": "2021-02-21T17:18:01.408677Z"
    },
    "papermill": {
     "duration": 6.702636,
     "end_time": "2021-02-21T17:18:01.410656",
     "exception": false,
     "start_time": "2021-02-21T17:17:54.708020",
     "status": "completed"
    },
    "scrolled": true,
    "tags": [],
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of Extra-Flex Controls 979 \n",
      "Coefficient for OLS with extra flex controls -0.05950266"
     ]
    }
   ],
   "source": [
    "\n",
    "extraflex <- lwage ~ sex + (exp1+exp2+exp3+exp4+shs+hsg+scl+clg+occ2+ind2+mw+so+we)^2\n",
    "\n",
    "control.fit <- lm(extraflex, data=data)\n",
    "#summary(control.fit)\n",
    "control.est <- summary(control.fit)$coef[2,1]\n",
    "\n",
    "\n",
    "cat(\"Number of Extra-Flex Controls\", length(control.fit$coef)-1, \"\\n\")\n",
    "\n",
    "\n",
    "cat(\"Coefficient for OLS with extra flex controls\", control.est)\n",
    "\n",
    "\n",
    "#summary(control.fit)\n",
    "\n",
    "\n",
    "\n",
    "HCV.coefs <- vcovHC(control.fit, type = 'HC');\n",
    "\n",
    "n= length(wage); p =length(control.fit$coef);\n",
    "\n",
    "control.se <- sqrt(diag(HCV.coefs))[2]*sqrt(n/(n-p)) # Estimated std errors\n",
    "\n",
    "# crude adjustment for the effect of dimensionality on OLS standard errors, motivated by Cattaneo, Jannson, and Newey (2018)\n",
    "\n",
    "# for really correct way of doing this, we need to implement Cattaneo, Jannson, and Newey (2018)'s procedure."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.028689,
     "end_time": "2021-02-21T17:18:37.699906",
     "exception": false,
     "start_time": "2021-02-21T17:18:37.671217",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## **Cross-Validation in Lasso Regression - Manual Implementation Task**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "install.packages(\"ggplot2\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "library(caret)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**1. Data Preparation**\n",
    "\n",
    "Load the March Supplement of the U.S. Current Population Survey, year 2015. (wage2015_subsample_inference.Rdata)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "load(\"..\\..\\data\\wage2015_subsample_inference.csv\")\n",
    "\n",
    "# Print a summary of the data frame\n",
    "print(\"Summary of the data:\")\n",
    "summary(data)\n",
    "\n",
    "# Print dimensions of the data frame\n",
    "print(\"Dimensions of the data:\")\n",
    "dim(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "flex <- lwage ~ sex + shs + hsg + scl + clg + occ2 + ind2 + mw + so + we +\n",
    "  (exp1 + exp2 + exp3 + exp4) * (shs + hsg + scl + clg + occ2 + ind2 + mw + so + we)\n",
    "\n",
    "# Fit the model using lm() function for OLS regression\n",
    "flex_results <- lm(flex, data=data)\n",
    "\n",
    "summary(flex_results)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "# Get exogenous variables from the flexible model\n",
    "X <- model.matrix(flex_results)\n",
    "\n",
    "# Set endogenous variable\n",
    "y <- data$lwage  # Directly from the data frame\n",
    "\n",
    "# Alternatively, extracting response variable from the model object\n",
    "y_model <- model.response(model.frame(flex_results))\n",
    "\n",
    "# Verify the contents\n",
    "head(X)  # Shows the first few rows of the model matrix\n",
    "head(y)  # Shows the first few values of the response variable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "set.seed(24)  # For reproducibility\n",
    "\n",
    "# Calculate the number of observations to split on\n",
    "n <- nrow(X)\n",
    "train_size <- floor(0.8 * n)\n",
    "\n",
    "# Randomly sample indices for the training data\n",
    "train_indices <- sample(seq_len(n), size = train_size)\n",
    "\n",
    "# Create training and test datasets\n",
    "X_train <- X[train_indices, , drop = FALSE]\n",
    "X_test <- X[-train_indices, , drop = FALSE]\n",
    "y_train <- y[train_indices]\n",
    "y_test <- y[-train_indices]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "# Calculate the mean and standard deviation from the training set\n",
    "train_mean <- apply(X_train, 2, mean)\n",
    "train_sd <- apply(X_train, 2, sd)\n",
    "\n",
    "# Standardize the training data\n",
    "X_train_scaled <- sweep(X_train, 2, train_mean, FUN = \"-\")\n",
    "X_train_scaled <- sweep(X_train_scaled, 2, train_sd, FUN = \"/\")\n",
    "\n",
    "# Standardize the test data using the same mean and standard deviation as calculated from the training set\n",
    "X_test_scaled <- sweep(X_test, 2, train_mean, FUN = \"-\")\n",
    "X_test_scaled <- sweep(X_test_scaled, 2, train_sd, FUN = \"/\")\n",
    "\n",
    "# Check the results of scaling\n",
    "head(X_train_scaled)\n",
    "head(X_test_scaled)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2. Define a Range of Alpha (Lambda in our equation) Values**\n",
    "\n",
    "We create a list or array of alpha values to iterate over. These will be the different regularization parameters we test. We started testing from 0.1 to 0.5 and found that the MSE in cross-validation was reducing when the alpha value was incrementing. Therefore, we tried with higher values."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "alphas <- seq(0.1, 0.5, by = 0.1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**3. Partition the Dataset for k-Fold Cross-Validation**\n",
    "\n",
    "We divide the dataset into 5 subsets (or folds). Since we are working with a regression task (predicting the log of wage), we use the K-Fold cross-validator from sklearn. We ensure the data is shuffled by adding 'shuffle=True' and set a random state for a reproducible output."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "set.seed(24)  # Set the random seed for reproducibility\n",
    "\n",
    "# Create a K-fold cross-validation object\n",
    "kf <- createFolds(y = 1:nrow(X_train), k = 5, list = TRUE, returnTrain = FALSE)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**4. Lasso Regression Implementation**\n",
    "\n",
    "Implement a function to fit a Lasso Regression model given a training dataset and an alpha value. The function should return the model's coefficients and intercept."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "lasso_regression <- function(X_train, y_train, alpha, iterations=100, learning_rate=0.01) {\n",
    "  # Get the dimensions of the training data\n",
    "  m <- nrow(X_train)\n",
    "  n <- ncol(X_train)\n",
    "  \n",
    "  # Initialize weights (coefficients) and bias (intercept)\n",
    "  W <- matrix(0, nrow = n, ncol = 1)  # Coefficients\n",
    "  b <- 0                                # Intercept\n",
    "  \n",
    "  # Perform gradient descent\n",
    "  for (i in 1:iterations) {\n",
    "    Y_pred <- X_train %*% W + b  # Predicted values\n",
    "    \n",
    "    dW <- matrix(0, nrow = n, ncol = 1)  # Initialize gradient of weights\n",
    "    for (j in 1:n) {\n",
    "      if (W[j, 1] > 0) {\n",
    "        dW[j, 1] <- (-2 * sum(X_train[, j] * (y_train - Y_pred)) + alpha) / m\n",
    "      } else {\n",
    "        dW[j, 1] <- (-2 * sum(X_train[, j] * (y_train - Y_pred)) - alpha) / m\n",
    "      }\n",
    "    }\n",
    "    \n",
    "    db <- -2 * sum(y_train - Y_pred) / m  # Gradient of bias\n",
    "    \n",
    "    # Update weights and bias using gradient descent\n",
    "    W <- W - learning_rate * dW\n",
    "    b <- b - learning_rate * db\n",
    "  }\n",
    "  \n",
    "  # Return weights (coefficients) and bias (intercept)\n",
    "  return(list(W = W, b = b))\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**5. Cross-Validation Loop and 6. Selection of Optimal Alpha**\n",
    "\n",
    "We immplement a for loop to fit the lasso regression. Also, we find the best value of alpha that reduces the average MSE for each fold."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "# Cross-validation function to calculate average MSE for given alpha values\n",
    "cross_validate_lasso <- function(X_train, y_train, alphas, kf, iterations=100, learning_rate=0.01) {\n",
    "  avg_mse_values <- numeric(length(alphas))\n",
    "  min_avg_mse <- Inf\n",
    "  best_alpha <- NULL\n",
    "  \n",
    "  for (i in seq_along(alphas)) {\n",
    "    alpha <- alphas[i]\n",
    "    mse_list <- numeric(kf$n)\n",
    "    \n",
    "    for (fold in 1:kf$n) {\n",
    "      train_index <- kf$inFold[[fold]]\n",
    "      val_index <- kf$outFold[[fold]]\n",
    "      \n",
    "      X_train_fold <- X_train[train_index, ]\n",
    "      X_val_fold <- X_train[val_index, ]\n",
    "      y_train_fold <- y_train[train_index]\n",
    "      y_val_fold <- y_train[val_index]\n",
    "      \n",
    "      # Train Lasso regression model with the current alpha\n",
    "      model <- lasso_regression(X_train_fold, y_train_fold, alpha, iterations, learning_rate)\n",
    "      W <- model$W\n",
    "      b <- model$b\n",
    "      \n",
    "      # Make predictions on validation set\n",
    "      y_pred_val <- X_val_fold %*% W + b\n",
    "      \n",
    "      # Calculate MSE for this fold\n",
    "      mse_fold <- mean((y_val_fold - y_pred_val)^2)\n",
    "      mse_list[fold] <- mse_fold\n",
    "    }\n",
    "    \n",
    "    # Calculate average MSE across all folds\n",
    "    avg_mse <- mean(mse_list)\n",
    "    avg_mse_values[i] <- avg_mse\n",
    "    cat(sprintf(\"Alpha=%.1f, Average MSE: %.5f\\n\", alpha, avg_mse))\n",
    "    \n",
    "    # Update best alpha and minimum average MSE\n",
    "    if (avg_mse < min_avg_mse) {\n",
    "      min_avg_mse <- avg_mse\n",
    "      best_alpha <- alpha\n",
    "    }\n",
    "  }\n",
    "  \n",
    "  cat(sprintf(\"Best Alpha: %.1f, Minimum Average MSE: %.5f\\n\", best_alpha, min_avg_mse))\n",
    "  \n",
    "  # Plotting the cross-validated MSE for each alpha value\n",
    "  plot(alphas, avg_mse_values, type = \"o\", pch = 19, lty = 1, col = \"blue\",\n",
    "       xlab = \"Alpha\", ylab = \"Average MSE\",\n",
    "       main = \"Cross-Validated MSE for Different Alpha Values\",\n",
    "       xlim = range(alphas), ylim = range(avg_mse_values),\n",
    "       xaxt = \"n\")\n",
    "  axis(1, at = alphas, labels = alphas)\n",
    "  grid()\n",
    "}\n",
    "\n",
    "# Perform cross-validated Lasso regression\n",
    "cross_validate_lasso(X_train, y_train, alphas, kf, iterations = 100, learning_rate = 0.01)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**7. Model Training and Evaluation**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "# Make predictions on test data\n",
    "y_pred <- X_test %*% W + b"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "vscode": {
     "languageId": "r"
    }
   },
   "outputs": [],
   "source": [
    "lasso_corr <- cor(y_test, y_pred)\n",
    "lasso_mae <- mean(abs(y_test - y_pred))\n",
    "lasso_mse <- mean((y_test - y_pred)^2)\n",
    "\n",
    "# Print results\n",
    "cat(sprintf(\"Correlation: %.4f\\n\", lasso_corr))\n",
    "cat(sprintf(\"MAE: %.4f\\n\", lasso_mae))\n",
    "cat(sprintf(\"MSE: %.4f\\n\", lasso_mse))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**8. Report Results**\n",
    "\n",
    "We began by selecting the parameters for a flexible model, one that includes interactions. After selecting the parameters, we found that the alpha value that produced the lowest mean squared error (MSE) in cross-validation was 60. We then trained the model using all the available training data with the best alpha value. Using the fitted betas, we predicted the lwage using the test X vector. The resulting MSE in the test data was 0.3569, which was lower than in the training data (which was 0.41906). This indicates that the model is not overfitting and that we have found a good correlation score (R square) of 50%."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.3.3"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 53.035585,
   "end_time": "2021-02-21T17:18:37.837719",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2021-02-21T17:17:44.802134",
   "version": "2.2.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
